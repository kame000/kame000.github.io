(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{502:function(t,i,n){"use strict";n.r(i);var l=n(2),o=Object(l.a)({},(function(){var t=this,i=t._self._c;return i("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[i("h2",{attrs:{id:"iptables利用connlimit模块限制同一ip连接connlimit功能"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#iptables利用connlimit模块限制同一ip连接connlimit功能"}},[t._v("#")]),t._v(" iptables利用connlimit模块限制同一IP连接connlimit功能")]),t._v(" "),i("ul",[i("li",[t._v("connlimit模块允许你限制每个客户端IP的并发连接数，即每个IP同时连接到一个服务器个数。")]),t._v(" "),i("li",[t._v("connlimit模块主要可以限制内网用户的网络使用，对服务器而言则可以限制每个IP发起的连接数。")])]),t._v(" "),i("h2",{attrs:{id:"connlimit参数"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#connlimit参数"}},[t._v("#")]),t._v(" connlimit参数")]),t._v(" "),i("ul",[i("li",[t._v("--connlimit-above n 　　　＃限制为多少个")]),t._v(" "),i("li",[t._v("--connlimit-mask n 　　　 ＃这组主机的掩码,默认是connlimit-mask 32 ,即每个IP.")])]),t._v(" "),i("h2",{attrs:{id:"例子"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#例子"}},[t._v("#")]),t._v(" 例子")]),t._v(" "),i("ul",[i("li",[i("p",[t._v("限制同一IP同时最多100个http连接")]),t._v(" "),i("p",[i("code",[t._v("iptables -I INPUT -p tcp --syn --dport 80 -m connlimit --connlimit-above 100 -j REJECT")])])]),t._v(" "),i("li",[i("p",[t._v("只允许每组C类IP同时100个http连接")]),t._v(" "),i("p",[i("code",[t._v("iptables -p tcp --syn --dport 80 -m connlimit --connlimit-above 100 --connlimit-mask 24 -j REJECT")])])]),t._v(" "),i("li",[i("p",[t._v("只允许每个IP同时5个80端口转发,超过的丢弃")]),t._v(" "),i("p",[i("code",[t._v("iptables -I FORWARD -p tcp --syn --dport 80 -m connlimit --connlimit-above 5 -j DROP")])])]),t._v(" "),i("li",[i("p",[t._v("限制某IP最多同时100个http连接")]),t._v(" "),i("p",[i("code",[t._v("iptables -A INPUT -s 222.222.222.222 -p tcp --syn --dport 80 -m connlimit --connlimit-above 100 -j REJECT")])])]),t._v(" "),i("li",[i("p",[t._v("限制每IP在一定的时间(比如60秒)内允许新建立最多100个http连接数")]),t._v(" "),i("p",[i("code",[t._v("iptables -A INPUT -p tcp --dport 80 -m recent --name BAD_HTTP_ACCESS --update --seconds 60 --hitcount 100 -j REJECT")])]),t._v(" "),i("p",[i("code",[t._v("iptables -A INPUT -p tcp --dport 80 -m recent --name BAD_HTTP_ACCESS --set -j ACCEPT")])])])])])}),[],!1,null,null,null);i.default=o.exports}}]);