(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{419:function(s,t,a){"use strict";a.r(t);var e=a(2),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"django-rest-framework-教程及api向导"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#django-rest-framework-教程及api向导"}},[s._v("#")]),s._v(" Django Rest Framework 教程及API向导")]),s._v(" "),t("h2",{attrs:{id:"一、请求-request"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、请求-request"}},[s._v("#")]),s._v(" 一、请求（Request）")]),s._v(" "),t("p",[s._v("REST_FRAMEWORK 中的 "),t("code",[s._v("Request")]),s._v("扩展了标准的HttpRequest,为 REST_FRAMEWORK增加了灵活的request解析和request认证。")]),s._v(" "),t("ul",[t("li",[s._v("请求")])]),s._v(" "),t("p",[t("code",[s._v(".data")]),s._v(": 获取请求的主体，相当于request.POST和request.FILES")]),s._v(" "),t("p",[t("code",[s._v(".query_params")]),s._v(":   request.GET的重命名")]),s._v(" "),t("p",[t("code",[s._v(".parsers:")]),s._v("  APIView类或@api_view装饰将确保这个属性将自动设置为一个解析器实例列表")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("内容协商\n.accepted_render: 接受渲染一个对象内容协商\n.accepted_media_type: 接受的媒体类型")])]),s._v(" "),t("li",[t("p",[s._v("身份验证\n.user:  通常返回django.contrib.auth.models.user的对象。虽然行为取决于所使用的身份验证策略。\n如果请求用户没有被认证，request.user是一个django.contrib.auth.models.Anoymoser对象。\n.auth:  被认证的后才会被使用，返回任何额外身份的环境。\n.authenticators:  APIView类或@api_view装饰将确保这个属性将自动设置为一个认证实例列表")])]),s._v(" "),t("li",[t("p",[s._v("浏览器增强方法")])])]),s._v(" "),t("blockquote",[t("p",[s._v("django rest framework提供一些附加的表单提交方法:PUT,PATCH,DELETE")])]),s._v(" "),t("p",[t("code",[s._v(".method")]),s._v(": 返回一个大写的HTTP请求方法字符串，包含了PUT,PATCH,DELETE等。")]),s._v(" "),t("p",[t("code",[s._v(".content_type")]),s._v(": 返回一个字符串对象代表HTTP请求的媒体类型的身体,或如果没有媒体类型提供一个空字符串。\n同样可以使用：request.META.get(‘HTTP_CONTENT_TYPE’)")]),s._v(" "),t("p",[t("code",[s._v(".stream")]),s._v(": 返回一个请求主体类容的流。")]),s._v(" "),t("ul",[t("li",[s._v("支持其他标准的HttpResquest属性\n.META/.session/等等")])]),s._v(" "),t("h2",{attrs:{id:"二、response-响应"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、response-响应"}},[s._v("#")]),s._v(" 二、Response（响应）")]),s._v(" "),t("blockquote",[t("p",[s._v("你需要使用一个APIView类或@api_view函数返回response对象的views")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("创建Response\n"),t("code",[s._v("from rest_framework.response import Response")]),s._v("\n例: "),t("code",[s._v("Response(data, status=None, template_name=None, headers=None, content_type=None)")])])]),s._v(" "),t("li",[t("p",[t("code",[s._v("data")]),s._v(": 响应serialized(序列化)后的数据")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("status")]),s._v(": 定义响应状态码，默认200")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("template_name")]),s._v(": 如果HTMLRender被选择，返回一个模板")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("headers")]),s._v(": 是关于HTTP请求头的一个字典")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("content_type")]),s._v(": 响应内容类型，一般会根据内容自动协商。")])]),s._v(" "),t("li",[t("p",[s._v("其他标准的HttpResponse属性")])])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("response "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nresponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("‘Cache"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ‘no"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cache’\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("render"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 响应序列化的数据。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"三、基本视图类-apiview-api-view"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、基本视图类-apiview-api-view"}},[s._v("#")]),s._v(" 三、基本视图类 (APIView/@api_view)")]),s._v(" "),t("ol",[t("li",[s._v("类基础视图（APIView）")])]),s._v(" "),t("p",[s._v("DRF不同于django常规的view类，他有如下几点优点：")]),s._v(" "),t("ul",[t("li",[s._v("提供了更好用的"),t("code",[s._v("request")]),s._v("对象，不同于普通的django HttpRequest更好用。")]),s._v(" "),t("li",[s._v("封装了"),t("code",[s._v("Response")]),s._v("对象，代替了原有的django HttpResponse，视图将管理内容协商并设置正确的渲染器的响应。")]),s._v(" "),t("li",[s._v("任何"),t("code",[s._v("APIException")]),s._v("异常将会被捕捉，并做适当的响应。")]),s._v(" "),t("li",[s._v("传入的请求将身份验证和适当的权限和节流检查将之前运行调度请求处理程序的方法。\n一个小例子：")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("views "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" APIView\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("response "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Response\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" authenication"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" permissions\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ListUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("APIView"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[t("strong",[s._v("展示系统中所有的用户")])]),s._v(" "),t("ul",[t("li",[s._v("需要令牌认证。")]),s._v(" "),t("li",[s._v("只有admin用户能够访问这一个视图")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("authentication_classes "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("authentication"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TokenAuthentication"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 认证策略属性")]),s._v("\npermission_classes "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("permissions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("IsAdminUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 权限策略属性")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" requeset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n返回一个用户列表\n"""')]),s._v("\nusernames "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("username "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("  User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("usernames"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("ol",[t("li",[s._v("API策略属性\n以下的API策略属性应用于APIView，控制视图的策略：")])]),s._v(" "),t("p",[t("code",[s._v("renderer_classes")]),s._v("： 渲染器类")]),s._v(" "),t("p",[t("code",[s._v("parser_classes")]),s._v("： 解释器类")]),s._v(" "),t("p",[t("code",[s._v("authentication_classes")]),s._v("： 权限类")]),s._v(" "),t("p",[t("code",[s._v("throttle_classes")]),s._v("：节流类")]),s._v(" "),t("p",[t("code",[s._v("permission_classes")]),s._v("： 权限类")]),s._v(" "),t("p",[t("code",[s._v("content_negotiation_class")]),s._v("： 内容协商类")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("API 策略方法\n以下的策略方法用在API的策略，通常不用重写它：")])]),s._v(" "),t("p",[t("code",[s._v("get_renderers(self)")]),s._v(":  获取渲染器方法\n"),t("code",[s._v("get_parsers(self)")]),s._v(": 获取解释器方法\n"),t("code",[s._v("get_authenticators(self)")]),s._v(": 或缺认证方法\n"),t("code",[s._v("get_throttles(self)")]),s._v(": 获取节流方法\n"),t("code",[s._v("get_permissions(self)")]),s._v(":  获取权限方法\n"),t("code",[s._v("get_content_negotiator(self)")]),s._v(": 获取内容协商方法")]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("API策略实施方法")])]),s._v(" "),t("p",[s._v("下列方法之前被称为调度处理程序方法：")]),s._v(" "),t("p",[t("code",[s._v("check_permissions(self, request)")]),s._v(": 检查权限")]),s._v(" "),t("p",[t("code",[s._v("check_throttles(self, request)")]),s._v(": 检查节流")]),s._v(" "),t("p",[t("code",[s._v("check_content_negotiation(self, request, force=False)")]),s._v(": 检查内容协商")]),s._v(" "),t("ol",[t("li",[s._v("调度方法")])]),s._v(" "),t("p",[s._v("这些执行任何操作,需要发生之前或之后调用处理程序方法等.\n"),t("code",[s._v("initial(self, request, *args, **kwargs)")]),s._v(": 执行任何操作,需要发生在处理程序方法之前被调用。这个方法是用来执行权限和节流,并执行内容协商。")]),s._v(" "),t("p",[t("code",[s._v("handle_exception(self, exc)")]),s._v("：抛出的任何异常处理程序方法将被传递给这个方法,而返回响应实例,或者re-raises异常。\n"),t("code",[s._v("initialize_request(self, request, *args, **kwargs)")]),s._v("：确保请求对象传递给处理程序方法是request的一个实例，而不是django的HttpRequest")]),s._v(" "),t("p",[t("code",[s._v("finalize_response(self, request, response, *args, **kwargs)")]),s._v("：确保任何响应处理程序方法返回的对象将被呈现到正确的内容类型")]),s._v(" "),t("ol",[t("li",[s._v("函数基础视图（@api_view()）\nDRF同样提供了另外一种函数基础视图来装饰django的普通视图，我们同样可以使用request来接受请求和response响应。\n一个小例子：")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decorators "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" api_view\n\n"),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@api_view")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hello_world")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("“message”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("”Hello world!”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ol",[t("li",[s._v("api_view()使用方法")])]),s._v(" "),t("blockquote",[t("p",[s._v("这个视图将使用默认渲染器、解析器、身份验证设置中指定的类等。通常默认只有GET方法，其他请求方法会报405错误，我们可以手动添加方法为这\n装饰器指定request方法。")])]),s._v(" "),t("p",[s._v("像这样：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@api_view")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("‘GET’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ‘POST’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hello_world")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("method  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" ‘POST’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("“message”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("”Got some data”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" “data”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("“messsage”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("”Hello world!”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ol",[t("li",[s._v("API策略装饰器\nDRF提供了很多附加的装饰器，我们可以添加到@api_view()后面，例如要加入一个节流的装饰器来确保特定用户每天只能一次通过这个视图，我\n我们就要用到@throttle_classes装饰器：")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decorators "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" api_view"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" throttle_classes\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("throttling "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" UserRateThrottle\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OncePerDayUserThrottle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("UserRateThrottle"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nrate "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" “"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("day”\n\n"),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@api_view")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("‘GET’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@throttle_classes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OncePerDayUserThrottle"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("view")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("“message”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("”Hello "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" to day! see you tomorrow!”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("其他可用API的装饰器：\n@renderer_classes(…)\n@parser_classes(…)\n@authentication_classes(…)\n@throttle_classes(…)\n@permission_classes(…)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"四、-通用视图-generic-views"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、-通用视图-generic-views"}},[s._v("#")]),s._v(" 四、 通用视图（Generic views）")]),s._v(" "),t("blockquote",[t("p",[s._v("基于类视图的主要好处之一是他们允许您编写可重用的行为.\nREST框架提供的通用视图允许您快速构建API观点紧密地映射到您的数据库模型.\n如果通用视图不适合你的需要API,您可以使用常规APIView类,或重用mixin和基类使用的通用视图来组成自己的组可重用通用视图。")])]),s._v(" "),t("h3",{attrs:{id:"通用视图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通用视图"}},[s._v("#")]),s._v(" 通用视图")]),s._v(" "),t("p",[s._v("同样我们可以设置一些类属性在通用视图内，也可以根据特殊要写重写它的内部视图方法。一个小例子：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("contrib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("auth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("models "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" User\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" myapp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("serializers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" UserSerializer\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" generics\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("permissions "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" IsAdminUser\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("generics"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ListCreateAPIView"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nqueryset "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nserializer_class "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" UserSerializer\npermission_classes "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IsAdminUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("list")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Note the use of get_queryset() instead of self.queryset")]),s._v("\nqueryset "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_queryset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nserializer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" UserSerializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("queryset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" many"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("serializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("在urls配置中，"),t("strong",[s._v("我们可以使用.as_views()来转换成视图函数")]),s._v("，当然也可以配置一些属性")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("url"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r’"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("users"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ListCreateAPIView"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("as_view"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("queryset"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" serializer_class"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("UserSerializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("’user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),s._v("’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"genericapiview通用视图api参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#genericapiview通用视图api参考"}},[s._v("#")]),s._v(" GenericAPIView通用视图API参考：")]),s._v(" "),t("p",[s._v("GenericAPIView继承了DRF的APIView类，为list和detail视图增加了一些一般需求行为方法（提供queryset）。")]),s._v(" "),t("h4",{attrs:{id:"属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#属性"}},[s._v("#")]),s._v(" 属性")]),s._v(" "),t("p",[t("strong",[t("code",[s._v("基本属性")])]),s._v("：")]),s._v(" "),t("p",[t("code",[s._v("queryset")]),s._v(": 用于返回query对象集合，也可以使用get_queryset()方法。")]),s._v(" "),t("p",[t("code",[s._v("serializer_class")]),s._v(": 序列化器类,应该用于输入进行验证和反序列化,并用于序列化输出。通常情况下,你必须设置这个属性,或重写get_serializer_class()方法。")]),s._v(" "),t("p",[t("code",[s._v("lookup_field")]),s._v(": 模型的字段应该用于执行对象查找个别的模型实例")]),s._v(" "),t("p",[t("code",[s._v("ookup_url_kwarg")]),s._v(":URL应该用于对象查找关键字参数")]),s._v(" "),t("p",[t("strong",[t("code",[s._v("分页属性")])]),s._v("：\n"),t("code",[s._v("pagination_class")]),s._v(": 用于返回一个分页列表视图的分页类，默认与settings中设置的"),t("code",[s._v("DEFAULT_PAGINATION_CLASS")]),s._v(" 值相同，\n可以通过"),t("code",[s._v("’rest_framework.pagination.PageNumberPagination’")]),s._v("设置分页数")]),s._v(" "),t("p",[t("strong",[t("code",[s._v("过滤器属性")])]),s._v("：")]),s._v(" "),t("p",[t("code",[s._v("filter_backends")]),s._v(": 过滤queryset的类列表，和在settings中设置DEFAULT_FILTER_BACKENDS 一样")]),s._v(" "),t("h4",{attrs:{id:"方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#方法"}},[s._v("#")]),s._v(" 方法")]),s._v(" "),t("p",[t("em",[t("strong",[s._v("基本方法")])]),s._v("：")]),s._v(" "),t("p",[t("code",[s._v("get_queryset()")]),s._v(": 返回queryset。（详情见官网http://www.django-rest-framework.org/api-guide/generic-views/）")]),s._v(" "),t("p",[t("code",[s._v("get_object()")]),s._v(":获取某一个具体的model实例对象。")]),s._v(" "),t("p",[t("em",[t("strong",[s._v("保存与删除挂钩方法：")])])]),s._v(" "),t("blockquote",[t("p",[s._v("以下方法是mixins类提供，提供简单的对象保存和删除的行为重写：")])]),s._v(" "),t("p",[t("code",[s._v("perform_create(self, serializer)")]),s._v(": "),t("code",[s._v("CreateModelMixin")]),s._v(" 当要保存对象时候会被调用")]),s._v(" "),t("p",[t("code",[s._v("perform_update(self, serializer)")]),s._v(":"),t("code",[s._v("UpdateModelMixin")]),s._v(" 当要更新对象时候会被调用")]),s._v(" "),t("p",[t("code",[s._v("perform_destroy(self, instance)")]),s._v(": "),t("code",[s._v("DestoryModelMixin")]),s._v(" 当药删除对象时候会被调用")]),s._v(" "),t("h3",{attrs:{id:"mixins"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mixins"}},[s._v("#")]),s._v(" Mixins")]),s._v(" "),t("blockquote",[t("p",[s._v("mixin类提供用于提供基础视图的操作行为。注意,mixin类提供操作方法而不是定义处理程序方法,比如. get()和. post(),直接。这允许更灵活的组合的行为。")])]),s._v(" "),t("p",[s._v("通过rest_framework.mixins引用:")]),s._v(" "),t("p",[t("code",[s._v("ListModelMixin")]),s._v("：提供"),t("code",[s._v("list方法")]),s._v("，列出queryset")]),s._v(" "),t("p",[t("code",[s._v("CreateModelMixin")]),s._v("： 提供"),t("code",[s._v("create方法")]),s._v("，创建和保存一个Model对象")]),s._v(" "),t("p",[t("code",[s._v("RetrieveModelMixin")]),s._v("：提供"),t("code",[s._v("retrieve方法")]),s._v("，检索一个存在的model对象")]),s._v(" "),t("p",[t("code",[s._v("UpdateModelMixin")]),s._v("： 提供"),t("code",[s._v("Update方法")]),s._v("，更改一个模型对象")]),s._v(" "),t("p",[t("code",[s._v("DestroyModelMixin")]),s._v("：提供"),t("code",[s._v("destroy方法")]),s._v("，删除一个模型对象")]),s._v(" "),t("h3",{attrs:{id:"generic"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#generic"}},[s._v("#")]),s._v(" Generic")]),s._v(" "),t("p",[s._v("Generic通用视图类提供具体操作的通用视图类，可以理解为Generic.GenericAPIView和mixin类的合体.")]),s._v(" "),t("p",[s._v("通过rest_framework.generic.调用\n.CreateAPIView:")]),s._v(" "),t("h4",{attrs:{id:"创建一个模型实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建一个模型实例"}},[s._v("#")]),s._v(" 创建一个模型实例")]),s._v(" "),t("p",[t("strong",[s._v("提供post方法的处理器")]),s._v("\n继承于："),t("code",[s._v("GenericAPIView，CreateModelMixin .ListAPIView")]),s._v(":\n模型实例的集合")]),s._v(" "),t("p",[t("strong",[s._v("提供get方法处理器")]),s._v("\n继承于："),t("code",[s._v("GenericAPIView，ListModelMixin .RetrieveAPIView")]),s._v(":\n一个模型实例")]),s._v(" "),t("p",[t("strong",[s._v("提供get方法处理器")]),s._v("\n继承于："),t("code",[s._v("GenericAPIView，RetrieveModelMixin .DestoryAPIView")]),s._v(":")]),s._v(" "),t("h4",{attrs:{id:"删除一个模型实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除一个模型实例"}},[s._v("#")]),s._v(" 删除一个模型实例")]),s._v(" "),t("p",[s._v("提供delete方法处理器\n继承于："),t("code",[s._v("GenericAPIView，DestroyModelMixin .UpdateAPIView")]),s._v(":")]),s._v(" "),t("h4",{attrs:{id:"修改模型实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改模型实例"}},[s._v("#")]),s._v(" 修改模型实例，")]),s._v(" "),t("p",[s._v("提供put和patch方法处理器\n继承于：GenericAPIView，UpdateModelMixin\n.ListCreateAPIView:")]),s._v(" "),t("h4",{attrs:{id:"创建和展示一个模型实例集合"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建和展示一个模型实例集合"}},[s._v("#")]),s._v(" 创建和展示一个模型实例集合")]),s._v(" "),t("p",[s._v("提供get和post处理器\n继承于："),t("code",[s._v("GenericAPIView，ListModelMixin，CreateModelMixin .RetrieveUpdateAPIView")]),s._v(":")]),s._v(" "),t("h4",{attrs:{id:"读和改一个模型实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读和改一个模型实例"}},[s._v("#")]),s._v(" 读和改一个模型实例")]),s._v(" "),t("p",[s._v("提供get,put,patch处理器\n继承于："),t("code",[s._v("GenericAPIView，RetrieveModelMixin，UpdateModelMixin .RetrieveDestoryAPIView")]),s._v(":")]),s._v(" "),t("h4",{attrs:{id:"读和删除一个模型实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读和删除一个模型实例"}},[s._v("#")]),s._v(" 读和删除一个模型实例")]),s._v(" "),t("p",[s._v("提供get和delete处理器\n继承于："),t("code",[s._v("GenericAPIView，RetrieveModelMixin，DestroyModelMixin .RetrieveUpdateDestroyAPIView")]),s._v("：")]),s._v(" "),t("h4",{attrs:{id:"读、改和删一个模型实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读、改和删一个模型实例"}},[s._v("#")]),s._v(" 读、改和删一个模型实例")]),s._v(" "),t("p",[s._v("get, put, patch,delete处理器\n继承于："),t("code",[s._v("GenericAPIView，RetrieveModelMixin，UpdateModelMixin，DestroyModelMixin")])]),s._v(" "),t("h2",{attrs:{id:"五、视图集合viewsets"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、视图集合viewsets"}},[s._v("#")]),s._v(" 五、视图集合ViewSets")]),s._v(" "),t("p",[s._v("Django REST框架允许您将一组相关的逻辑视图在一个类，ViewSet类是一个简单类型的基于类的观点,没有提供任何方法处理程序如.get()或. post(),\n而代替提供方法比如.list()和create()。\n一个小例子：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("contrib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("auth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("models "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" User\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shortcuts "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" get_object_or_404\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" myapps"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("serializers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" UserSerializer\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" viewsets\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("response "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Response\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserViewSet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("viewsets"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ViewSet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n“””\nA simple ViewSet "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" listing "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" retrieving users"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n“””\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("list")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nqueryset "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nserializer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" UserSerializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("queryset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" many"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("serializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("retrieve")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pk"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nqueryset "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nuser "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" get_object_or_404"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("queryset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pk"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pk"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nserializer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" UserSerializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("serializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h3",{attrs:{id:"关于viewsets"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关于viewsets"}},[s._v("#")]),s._v(" 关于ViewSets")]),s._v(" "),t("p",[s._v("如果我们需要，我们需要为两个GET请求分开绑定视图：")]),s._v(" "),t("p",[t("code",[s._v("user_list = UserViewSet.as_view({“GET”:’list’}) user_detail = UserViewSet.as_view({‘GET’:’retrieve’})")])]),s._v(" "),t("p",[s._v("但是通常我们不会这样做，而是通过注册路由来配置url：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" myapp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("views "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" UserViewSet\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("routers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" DefaultRouter\nrouter "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DefaultRouter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nrouter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r’users’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" UserViewSet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nurlpatterns "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" router"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("urls\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("或许你会经常用到自己模型数据，而不是手动写视图集合，这样就要用到模型视图集合ModelViewSet:")]),s._v(" "),t("p",[t("code",[s._v("class UserViewSet(viewsets.ModelViewSet): “”” A viewset for viewing and editing user instance “”” serializer_class = UserSerializer queryset = User.objects.all()")])]),s._v(" "),t("p",[t("strong",[s._v("其他路由函数方法：")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserViewSet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("viewsets"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ViewSet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n“””\nExample empty viewset demonstrating the standard\nactions that will be handled by a router "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\nIf you’re using "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),s._v(" suffixes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" make sure to also include\nthe "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),s._v(" keyword argument "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" each action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n“””\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("list")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("retrieve")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pk"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pk"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("partial_update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pk"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("destroy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pk"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("p",[s._v("如果你有特别的需要被路由到的方法,可以将它们标记为需要路由使用@detail_route或@list_route修饰符。")]),s._v(" "),t("p",[t("code",[s._v("@detail_route(methods=[‘post’], permission_classes=[IsAdminOrIsSelf]) def set_password(self, request, pk=None): …")])]),s._v(" "),t("p",[s._v("可以通过访问"),t("code",[s._v("^users/{pk}/set_password/$")]),s._v("来访问改视图")]),s._v(" "),t("h3",{attrs:{id:"viewsets的api参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#viewsets的api参考"}},[s._v("#")]),s._v(" ViewSets的API参考")]),s._v(" "),t("p",[t("code",[s._v(".ViewSet")]),s._v("：\n继承了APIView，你可以使用一些标准的属性例如"),t("code",[s._v("permission_class,authentication_classes")]),s._v("去对视图做一些策略。ViewSet同样不提供具体\n行为方法的实现，你可以重写和定义一些请求处理方法。而代替了原来APIVIew的POST，GET等方法，取而代之的是list，create等方法。")]),s._v(" "),t("p",[t("code",[s._v(".GenericViewSet")]),s._v(":\n继承了"),t("code",[s._v("GenericAPIView")]),s._v("，提供了默认的"),t("code",[s._v("get_queryset()")]),s._v("和"),t("code",[s._v("get_object()")]),s._v("等方法来获取model数据，但不提供任何请求处理方法。\n"),t("code",[s._v(".ModelViewSet")]),s._v(":\n继承了GenericAPIView，增加了一些请求处理方法，如"),t("code",[s._v("list(), retrieve(),create()")]),s._v("等。")]),s._v(" "),t("p",[t("em",[t("strong",[s._v("例子：")])])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AccountViewSet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("viewsets"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ModelViewSet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n“””\nA simple ViewSet "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" viewing "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v(" editing accounts\n“””\nqueryset "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Account"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nserializer_class "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" AccountSerializer\npermissions_classes "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("IsAccountAdminOrReadOnly"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[t("code",[s._v(".ReadOnlyModelViewSet")]),s._v(":\n继承了GenericAPIView，只增加了只读的请求处理方法list()和retrieve()")]),s._v(" "),t("p",[s._v("自定义View类：\n只需要继承GenericAPIView, 增加mixins的相关处理方法。如：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CreatListRetrieveViewSet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mixins"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CreateModelMixin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nmixins"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ListModelMixin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nmixins"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("RetrieveModelMixin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nView"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GenericViewSet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"六、路由-routers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#六、路由-routers"}},[s._v("#")]),s._v(" 六、路由(routers)")]),s._v(" "),t("h3",{attrs:{id:"rest框架还支持自动django-url路由-并为您提供了一个简单的、快速的和一致的方式连接视图逻辑的url。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rest框架还支持自动django-url路由-并为您提供了一个简单的、快速的和一致的方式连接视图逻辑的url。"}},[s._v("#")]),s._v(" REST框架还支持自动Django URL路由,并为您提供了一个简单的、快速的和一致的方式连接视图逻辑的URL。")]),s._v(" "),t("p",[s._v("如果设置basename将自动生成基于queryset viewset的属性,如果它有一个。注意,如果viewset不包括queryset属性然后注册时必须设置base_name viewset。")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" routers\nrouter "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" routers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SimpleRouter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nrouter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r’users’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" UserViewSet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ‘users’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nrouter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r’accounts’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" AccountViewSet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nurlpatterns "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" router"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("urls\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[t("strong",[s._v("注意："),t("code",[s._v("router.register")]),s._v("有三个参数属性")]),s._v("：")]),s._v(" "),t("p",[t("code",[s._v("prefix")]),s._v("：这是url匹配正则表达式。")]),s._v(" "),t("p",[t("code",[s._v("viewset")]),s._v(": 指定视图集合")]),s._v(" "),t("p",[t("code",[s._v("base_name")]),s._v(": 基于基础的url名字设置。这个特别要注意，如果不加这个参数，那么视图集合必须要包含queryset这个属性。")]),s._v(" "),t("h3",{attrs:{id:"使用路由routers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用路由routers"}},[s._v("#")]),s._v(" 使用路由routers")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("router "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" routers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SimpleRouter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nrouter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r’users’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" UserViewSet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nurlpatterns "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\nurl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r’"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v("api"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" include"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("router"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("urls"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" namespace"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("’api’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("或者：urlpatterns +=router.urls")]),s._v(" "),t("h3",{attrs:{id:"detail-route-list-route指定路由"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#detail-route-list-route指定路由"}},[s._v("#")]),s._v(" @detail_route / @list_route指定路由")]),s._v(" "),t("p",[t("code",[s._v("@detail_route(methods=[‘post’], permission_classes=[IsAdminOrIsSelf]) ->指定post方法，权限为IsAdminOrIsSelf")])]),s._v(" "),t("h2",{attrs:{id:"七、解释器-parse"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#七、解释器-parse"}},[s._v("#")]),s._v(" 七、解释器(parse)")]),s._v(" "),t("h3",{attrs:{id:"设置解释器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置解释器"}},[s._v("#")]),s._v(" 设置解释器")]),s._v(" "),t("p",[s._v("设置成全局：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("REST_FRAMEWORK "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n‘DEFAULT_PARSER_CLASSES’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("‘rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parsers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("JSONParser’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("）\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("也可以在视图APIView中设置：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parsers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" JSONParser\nparser_class "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("JSONParser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n如果是@api_view装饰的视图：\n"),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@api_view")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("‘POST’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@parser_classes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("JSONParser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"api-参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#api-参考"}},[s._v("#")]),s._v(" API 参考")]),s._v(" "),t("p",[t("code",[s._v("JSONParse")]),s._v(": application/json")]),s._v(" "),t("p",[t("code",[s._v("FormParse")]),s._v(": application/x-www-form-urlencoded")]),s._v(" "),t("p",[t("code",[s._v("MultiPartParser")]),s._v(":  multipart/form-data")]),s._v(" "),t("p",[t("code",[s._v("FileUploadParser")]),s._v(": "),t("em",[s._v("/")]),s._v("\n–>file_obj = request.data[‘file’]")]),s._v(" "),t("h2",{attrs:{id:"八、渲染器-renders"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#八、渲染器-renders"}},[s._v("#")]),s._v(" 八、渲染器(renders)")]),s._v(" "),t("h3",{attrs:{id:"设置渲染器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置渲染器"}},[s._v("#")]),s._v(" 设置渲染器")]),s._v(" "),t("p",[s._v("设置成全局：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("REST_FRAMEWORK ={\n‘rest_framework.renderers.JSONRenderer’,\n‘rest_framework.renderers.BrowsableAPIRenderer’,\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("也可以在视图APIView中设置：\n"),t("code",[s._v("from rest_framework.renderers import JSONRenderer renderer_classes = (JSONRenderer, )")]),s._v("\n如果是@api_view装饰的视图：\n"),t("code",[s._v("@api_view([‘GET’]) @renderer_classes((JSONRenderer,))")])]),s._v(" "),t("h2",{attrs:{id:"九、序列化器serializers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#九、序列化器serializers"}},[s._v("#")]),s._v(" 九、序列化器serializers")]),s._v(" "),t("blockquote",[t("p",[s._v("序列化器可以将python的复杂数据格式渲染成json，xml等格式，同时也提供了反序列化器，可以将渲染成的数据解释成python的数据模型对象。它和django中\n的from表单用法很相似。")])]),s._v(" "),t("h3",{attrs:{id:"渲染序列化对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#渲染序列化对象"}},[s._v("#")]),s._v(" 渲染序列化对象：")]),s._v(" "),t("p",[s._v("可以将对象序列化成json,xml格式等")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("serializer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CommentSerializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("comment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nserializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# {’email’: ‘leila@example.com’, ‘content’: ‘foo bar’, ‘created’: ‘2016-01-27T15:17:10.375877′}")]),s._v("\n\n\njson "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" JSONRenderer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("render"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("serializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 渲染成json格式")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# b'{“email”:”leila@example.com”,”content”:”foo bar”,”created”:”2016-01-27T15:17:10.375877″}’")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"反序列化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#反序列化"}},[s._v("#")]),s._v(" 反序列化")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("from django.utils.six import BytesIO\nfrom rest_framework.parsers import JSONParser\n\nstream = BytesIO(json)\ndata = JSONParser().parse(stream)   # 解析json格式\n\nserializer.is_valid()\n# True\nserializer.validated_data\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"保存实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#保存实例"}},[s._v("#")]),s._v(" 保存实例")]),s._v(" "),t("p",[s._v("可以利用.create()和.update()方法\n调用.save()方法会执行上面两个方法，自动保存或者更新实例对象\n有时候，需要保存其他的信息，可以在参数中添加，如：\n"),t("code",[s._v("serializer.save(owner=request.user)")])]),s._v(" "),t("h3",{attrs:{id:"验证validation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证validation"}},[s._v("#")]),s._v(" 验证validation")]),s._v(" "),t("p",[s._v("当需要保存反序列化的数据时，我们往往需要在之前用"),t("code",[s._v("is_valid()")]),s._v("验证数据的合法性，如果不合法可以用\n"),t("code",[s._v("serializer.errors")]),s._v("得到该错误信息。这个错误信息可以根据error_message来进行自定义")]),s._v(" "),t("h3",{attrs:{id:"模型序列化modelserializer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#模型序列化modelserializer"}},[s._v("#")]),s._v(" 模型序列化ModelSerializer")]),s._v(" "),t("blockquote",[t("p",[s._v("模型序列化与字段序列化用法类似，只需在类的属性Meta中指定相应的模型，就会根据模型自动生成相应的字段")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AccountSerializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("serializers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ModelSerializer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Meta")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nmodel "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Account\nfields "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("‘"),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("id")]),s._v("’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ‘account_name’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ‘users’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ‘created’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"超链接模型序列化hyperlinkedmodelserializer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#超链接模型序列化hyperlinkedmodelserializer"}},[s._v("#")]),s._v(" 超链接模型序列化HyperlinkedModelSerializer")]),s._v(" "),t("p",[s._v("与模型序列化类似，只不过过了一个可链接的形式。")]),s._v(" "),t("h2",{attrs:{id:"十、序列化字段serializer-fields"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十、序列化字段serializer-fields"}},[s._v("#")]),s._v(" 十、序列化字段serializer fields")]),s._v(" "),t("h3",{attrs:{id:"核心参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#核心参数"}},[s._v("#")]),s._v(" 核心参数")]),s._v(" "),t("p",[t("code",[s._v("read_only")]),s._v(": 只读形式，只能序列化到api输出，不能被反序列化数据更新修改操作。默认False")]),s._v(" "),t("p",[t("code",[s._v("wirte_only")]),s._v(": 只写形式，只能被反序列化数据更新和创建，不能序列化表示。默认False")]),s._v(" "),t("p",[t("code",[s._v("required")]),s._v(": 必须字段，通常出现在反序列化的过程中，该字段必须有值。默认True")]),s._v(" "),t("p",[t("code",[s._v("allow_null")]),s._v("：是否允许为空，默认False")]),s._v(" "),t("p",[t("code",[s._v("default")]),s._v(": 默认值，")]),s._v(" "),t("p",[t("code",[s._v("source")]),s._v("：字段来源，为字段指定一个字段来源，如(source=’user.email’).")]),s._v(" "),t("p",[t("code",[s._v("validators")]),s._v(": 合法性函数列表，支持django的ValidationError包。")]),s._v(" "),t("p",[t("code",[s._v("error_message")]),s._v(": 一个错误信息的字典，包含null, blank, invalid, invalid_choice, unique等键值。")]),s._v(" "),t("p",[t("code",[s._v("label")]),s._v(":一篇简短的文本字符串,可以用作在HTML表单字段的名称或其他描述性的元素")]),s._v(" "),t("p",[t("code",[s._v("help_text")]),s._v(": 一个文本字符串,可以用作描述字段的HTML表单字段或其他描述性的元素。")]),s._v(" "),t("p",[t("code",[s._v("initial")]),s._v(": 用于预先填充HTML表单字段的值。")]),s._v(" "),t("p",[t("code",[s._v("style")]),s._v(": 字典的键-值对,可以用来控制渲染器应该如何呈现。")]),s._v(" "),t("h3",{attrs:{id:"字段类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#字段类型"}},[s._v("#")]),s._v(" 字段类型")]),s._v(" "),t("p",[t("code",[s._v("布尔字段BooleanField")]),s._v(": BoolenField(defalut=True)")]),s._v(" "),t("p",[t("code",[s._v("字符字段StringField")]),s._v(": CharField(max_length=None, min_length=None, allow_blank=False, trim_whitespace=True)")]),s._v(" "),t("p",[t("code",[s._v("邮箱字段EmailField")]),s._v(": EmailField(max_length=None, min_length=None, allow_blank=False)")]),s._v(" "),t("p",[t("code",[s._v("正则字段RegexField")]),s._v(": RegexField(regex, max_length=None, min_length=None, allow_blank=False)")]),s._v(" "),t("p",[t("code",[s._v("新闻标题字段SlugField：SlugField")]),s._v("(max_length=50, min_length=None, allow_blank=False)")]),s._v(" "),t("p",[t("code",[s._v("URL地址字段")]),s._v(" "),t("code",[s._v("UrlField")]),s._v(": URLField(max_length=200, min_length=None, allow_blank=False)")]),s._v(" "),t("p",[t("code",[s._v("UUID字段 UUIDField")]),s._v(": UUIDField(format=’hex_verbose’)   “de305d54-75b4-431b-adb2-eb6b9e546013″")]),s._v(" "),t("p",[t("code",[s._v("文件路径字段FilePathField")]),s._v("：FilePathField(path, match=None, recursive=False, allow_files=True, allow_folders=False, required=None, **kwargs)")]),s._v(" "),t("p",[t("code",[s._v("IP地址字段IPAddressField")]),s._v("：IPAddressField(protocol=’both’, unpack_ipv4=False, **options)\n*数字型字段：IntegerField、FloatField、DecimalField")]),s._v(" "),t("p",[t("code",[s._v("时间和日期字段：DateTimeField")]),s._v("：DateTimeField(format=None, input_formats=None)")]),s._v(" "),t("p",[s._v("DateField：\nTimeField：\nDurationField：\n"),t("code",[s._v("选择字段")]),s._v("：ChoiceField\n"),t("code",[s._v("文件字段")]),s._v("：FileField：FileField(max_length=None, allow_empty_file=False, use_url=UPLOADED_FILES_USE_URL)")]),s._v(" "),t("p",[t("code",[s._v("ImageField")]),s._v("：ImageField(max_length=None, allow_empty_file=False, use_url=UPLOADED_FILES_USE_URL)\n"),t("code",[s._v("模型字段")]),s._v("："),t("code",[s._v("ModelField")]),s._v("：ModelField(model_field Django ModelField instance)")]),s._v(" "),t("p",[t("code",[s._v("只读字段")]),s._v("：ReadOnlyField：")]),s._v(" "),t("h2",{attrs:{id:"十一、字段关系serializer-relations"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十一、字段关系serializer-relations"}},[s._v("#")]),s._v(" 十一、字段关系serializer relations")]),s._v(" "),t("p",[t("strong",[s._v("多对一")]),s._v("："),t("code",[s._v("ForeignKey")])]),s._v(" "),t("p",[t("strong",[s._v("多对多")]),s._v(": "),t("code",[s._v("ManyToManyField")])]),s._v(" "),t("p",[t("strong",[s._v("一对一")]),s._v("："),t("code",[s._v("OneToOneField")])]),s._v(" "),t("h3",{attrs:{id:"api参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#api参考"}},[s._v("#")]),s._v(" api参考")]),s._v(" "),t("p",[t("code",[s._v("tracks = serializers.StringRelatedField(many=True)")]),s._v("  # 字符串形式关系字段")]),s._v(" "),t("p",[t("code",[s._v("tracks = serializers.PrimaryKeyRelatedField(many=True, read_only=True)")]),s._v("# 主键形式关系字段")]),s._v(" "),t("p",[t("code",[s._v("tracks = serializers.HyperlinkedRelatedField(many=True, read_only=True, view_name=’track-detail’)")]),s._v(" # 超链接形式关系字段")]),s._v(" "),t("p",[t("code",[s._v("tracks = serializers.SlugRelatedField(many=True, read_only=True, slug_field=’title’)")]),s._v("  # 以小标题形式关系")]),s._v(" "),t("p",[t("code",[s._v("track_listing = serializers.HyperlinkedIdentityField(view_name=’track-list’)")]),s._v("  # 超链接身份关系")]),s._v(" "),t("h3",{attrs:{id:"嵌套关系"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#嵌套关系"}},[s._v("#")]),s._v(" 嵌套关系")]),s._v(" "),t("p",[s._v("序列化类中可以直接引用其他序列化化类\n十二、合法性验证(Validation)\n1、数据的唯一性UniqueValidator\n在模型中，只需设置字段的unique=True就会在该字段自动生成改唯一性判断\n例:slug = SlugField(max_length=100, validators=[UniqueValidator(queryset=BlogPost.objects.all(), messsage=”)])\n*queryset：模型数据对象集合")]),s._v(" "),t("p",[s._v("*message: 异常提示信息")]),s._v(" "),t("p",[s._v("2、数据字段的不重复性UniqueTogetherValidator")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Meta")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nvalidators "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\nUniqueTogetherValidator"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\nqueryset"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ToDoItem"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nfields"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("‘"),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),s._v("’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ‘position’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[t("code",[s._v("queryset")]),s._v("：模型数据对象集合")]),s._v(" "),t("p",[t("code",[s._v("fields")]),s._v(": 字段的集合元祖")]),s._v(" "),t("p",[t("code",[s._v("message")]),s._v(": 异常提示信息")]),s._v(" "),t("h2",{attrs:{id:"十三、认证authentication"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十三、认证authentication"}},[s._v("#")]),s._v(" 十三、认证Authentication")]),s._v(" "),t("h3",{attrs:{id:"设置认证方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置认证方案"}},[s._v("#")]),s._v(" 设置认证方案")]),s._v(" "),t("p",[t("strong",[s._v("可以在settings文件中配置")]),t("code",[s._v("DEFAULT_AUTHENTICATION_CLASSES：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("REST_FRAMEWORK = {\n‘DEFAULT_AUTHENTICATION_CLASSES’: (\n‘rest_framework.authentication.BasicAuthentication’,\n‘rest_framework.authentication.SessionAuthentication’,\n)\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[t("strong",[s._v("也可以在视图中设置")])]),s._v(" "),t("p",[s._v("(APIView)：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("authentication_classes = (SessionAuthentication, BasicAuthentication)\npermission_classes = (IsAuthenticated,)\n(@api_view)\n@authentication_classes((SessionAuthentication, BasicAuthentication))\n@permission_classes((IsAuthenticated,))\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"十四、权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十四、权限"}},[s._v("#")]),s._v(" 十四、权限")]),s._v(" "),t("h3",{attrs:{id:"设置权限方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置权限方案"}},[s._v("#")]),s._v(" 设置权限方案")]),s._v(" "),t("p",[t("strong",[s._v("可以在settings文件中配置")]),t("code",[s._v("DEFAULT_PERMISSION_CLASSES")])]),s._v(" "),t("p",[s._v("`REST_FRAMEWORK = {\n‘DEFAULT_PERMISSION_CLASSES’: (\n‘rest_framework.permissions.IsAuthenticated’,")]),s._v(" "),t("h1",{attrs:{id:"rest-framework-permissions-allowany"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rest-framework-permissions-allowany"}},[s._v("#")]),s._v(" ‘rest_framework.permissions.AllowAny’,")]),s._v(" "),t("p",[s._v(")\n}`\n*视图中设置：\n（APIView）")]),s._v(" "),t("p",[t("code",[s._v("permission_classes = (IsAuthenticated,) （@api_view） @permission_classes((IsAuthenticated, ))")])]),s._v(" "),t("h3",{attrs:{id:"api引用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#api引用"}},[s._v("#")]),s._v(" API引用")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("*AllowAny：允许任何\n*IsAuthenticated：是否被认证\n*IsAdminUser：是管理用户\n*IsAuthenticatedOrReadOnly：是被认证或者只读\n*DjangoModelPermissions：标准的django模型设置权限\n*DjangoModelPermissionsOrAnonReadOnly：标准的django模型处理或者只读权限\n*DjangoObjectPermissions：相比模型权限，只提供queryset和get_queryset方法。\n*自定义权限：\n继承BasePermission;\n重写：.has_permission(self, request, view)\n.has_object_permission(self, request, view, obj)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h2",{attrs:{id:"十五、节流trottling"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十五、节流trottling"}},[s._v("#")]),s._v(" 十五、节流Trottling")]),s._v(" "),t("blockquote",[t("p",[s._v("限制请求量")])]),s._v(" "),t("p",[s._v("1、设置节流方案")]),s._v(" "),t("p",[s._v("*可以在settings文件中配置DEFAULT_THROTTLE_CLASSES 和 DEFAULT_THROTTLE_RATES")]),s._v(" "),t("p",[t("code",[s._v("‘DEFAULT_THROTTLE_CLASSES’: ( ‘rest_framework.throttling.AnonRateThrottle’, ‘rest_framework.throttling.UserRateThrottle’ ), ‘DEFAULT_THROTTLE_RATES’: { ‘anon’: ‘100/day’, ‘user’: ‘1000/day’ }")])]),s._v(" "),t("p",[s._v("*可以在视图中设置：\n（APIView）")]),s._v(" "),t("p",[t("code",[s._v("throttle_classes = (UserRateThrottle,) （@api_view） @throttle_classes([UserRateThrottle])")])]),s._v(" "),t("h2",{attrs:{id:"十六、过滤器filtering"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十六、过滤器filtering"}},[s._v("#")]),s._v(" 十六、过滤器Filtering")]),s._v(" "),t("p",[s._v("通常drf的默认的通用list视图类要处理的是全部模型的查询集合集，如果我们要指定结果集，\n这就必须用到过滤器了。通常的方法是重写get_queryset(self)方法。\n例如：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 根据用户过滤\n\nclass PurchaseList(generics.ListAPIView):\nserializer_class = PurchaseSerializer\n\ndef get_queryset(self):\nuser = self.request.user\nreturn Purchase.objects.filter(purchase = user)\n# 根据url请求过滤\ndef get_queryset(self):\nusername = self.kwargs[‘username’]\nreturn Purchase.objects.filter(purchaser__username=username)\n# 根据请求参数过滤同上\ndef get_queryset(self):\nqueryset = Purchase.objects.all()\nusername = self.request.query_params.get(‘username’, None)\nif username is not None:\nqueryset = queryset.filter(purchaser__username=username)\nreturn queryset\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("p",[s._v("1、generic filter过滤\n*通过settings文件中配置过滤")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("REST_FRAMEWORK = {\n‘DEFAULT_FILTER_BACKENDS’: (‘rest_framework.filters.DjangoFilterBackend’,)\n}\n*也可通过视图中过滤\nfilter_backends = (filters.DjangoFilterBackend,)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("2、API向导\n*pip install django-filter\nfilter.DjangoFilterBackend")]),s._v(" "),t("p",[s._v("*filter_fields过滤字段")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProductList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("generics"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ListAPIView"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nquery "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nserializer_class "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ProductSerializer\nfilter_backends "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("filter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DjangoFilterBackend"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nfilter_fields "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("‘category’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ‘in_stock’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nhttp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("//")]),s._v("example"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("api"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("products?category"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("clothing"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("in_stock"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("filter_class指定一个过滤集合类\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" django_filters\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" myapp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("models "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Product\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" myapp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("serializers impoert ProductSerializer\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" filters\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" rest_framework "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" generics\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProductFilter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("FilterSet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nmin_price "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" django_filters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("NumberFilter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("’price’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lookup_type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("”gte”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmax_price "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" django_filters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("NumberFilter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("’price’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lookup_type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("”lte”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Meta")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nmodel "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Product\nfields "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("‘category’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ‘in_stock’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ‘min_price’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ‘max_price’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProductList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("generics"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ListAPIView"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nqueryset "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nserializer_class "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ProductSerializer\nfilter_backends "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("filter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DjangoFilterBackend"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nfilter_class "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ProductFilter\nhttp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("//")]),s._v("example"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("api"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("products?category"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("clothing"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("max_price"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.00")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("p",[s._v("同理双下划线强调名字：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("class ProductFilter(filters.FilterSet):\nclass Meta:\nmodel = Product\nfields = [‘category’, ‘in_stock’, ‘manufacturer__name’]\nhttp://example.com/api/products?manufacturer__name=foo\n上面例子等同于：\nclass ProductFilter(filter.FilterSet):\nmanufacturer = django_filters.CharFilter(name=”manufacter__name”)\n\nclass Meta:\nmodel = Product\nfields = [‘category’, ‘in_stock’, ‘manufacturer’]\nhttp://example.com/api/products?manufacturer=foo\n*search_fields 搜索字段\nclass UserListView(generics.ListAPIView):\nqueryset = User.object.all()\nserializer = UserSerializer\nfilter_backends = (filter.SearchFilter,)\nfilter_fields = (“suername”, ’email’)\nhttp://example.com/api/users?search=russell\n\n*ordring_fields排序字段\nclass UserList(generics.ListAPIView):\nqueryset = User.object.all()\nserializer_class = UserSerializer\nfilter_backends = (filter.OrderingFilter,)\nfilter_fields = ‘__all__’\nordering = (‘username’,)  # 默认排序字段\n*DjangoOjectPermissionFilter 对象权限的过滤器\nfilter_backends = (filter.DjangoObjectPermissionFilter,)\npermission_classes = (myapp.permissions.CustomObjectPermissions,)  # 自定义的权限类\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("p",[s._v("十七、分页Pagination")]),s._v(" "),t("p",[s._v("1、设置分页\n*可以在settings中设置分页样式")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("REST_FRAMEWORK = {\n‘DEFAULT_PAGINATION_CLASS’: ‘rest_framework.pagination.LimitOffsetPagination’\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("*修改分页样式")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("class LargeResultsSetPagination(PageNumberPagination):\npage_size = 1000\npage_size_query_param = ‘page_size’\nmax_page_size = 10000\n\nclass StandardResultsSetPagination(PageNumberPagination):\npage_size = 100\npage_size_query_param = ‘page_size’\nmax_page_size = 1000\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("*应用到视图中")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("class BillingRecordsView(generics.ListAPIView):\nqueryset = Billing.objects.all()\nserializer = BillingRecordsSerializer\npagination_class = LargeResultsSetPagination\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ol",[t("li",[s._v("API引用\n"),t("strong",[s._v("PageNumberPagination")]),s._v("\n设置全局的分页大小：")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("REST_FRAMEWORK "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n‘DEFAULT_PAGINATION_CLASS’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ‘rest_framework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pagination"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("PageNumberPagination’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n‘PAGE_SIZE’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);