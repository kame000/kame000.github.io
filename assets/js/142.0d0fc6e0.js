(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{547:function(s,a,n){"use strict";n.r(a);var t=n(2),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"grafana授权公司内部邮箱登录-ldap配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#grafana授权公司内部邮箱登录-ldap配置"}},[s._v("#")]),s._v(" grafana授权公司内部邮箱登录 ldap配置")]),s._v(" "),a("h3",{attrs:{id:"修改配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改配置"}},[s._v("#")]),s._v(" 修改配置")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/grafana/grafana.ini    （默认配置是这个）\n\n修改ldap相关配置如下\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("auth.ldap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nenabled "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 开启LDAP认证")]),s._v("\nconfig_file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /etc/grafana/ldap.toml   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 加载LDAP 配置文件    ")]),s._v("\nallow_sign_up "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 开启用户登录后，创建到内置用户")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[s._v("vim  /etc/grafana/ldap.toml\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 如下是 相关配置修改 ，请对应默认配置进行修改")]),s._v("\nverbose_logging = true       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 这个默认配置里面没有请自行添加")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("servers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v('\nhost = XXXX   //公司内部ldaphost\nport = XXXX       //公司内部ldapport\nuse_ssl = false\nssl_skip_verify = false\n\nbind_dn = "CN=XXXX'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("OU=XXXX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("OU=XXXX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("DC=XXXX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v('DC=com"   '),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 这个需要咨询域控管理员，填写具体的账号密码")]),s._v('\nbind_password = XXXX\nsearch_filter = "(sAMAccountName=%s)"\nsearch_base_dns = '),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"OU=XXXX,OU=XXXX,DC=XXXX,DC=XXXX"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("servers.attributes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v('\nname = "givenName"\nsurname = "sn"\nusername = "sAMAccountName"\nmember_of = "memberOf"\nemail =  "mail"\n\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("servers.group_mappings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v('\ngroup_dn = "CN=XXXX'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("OU=User Group"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("OU=XXXX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("DC=XXXX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v('DC=com"\norg_role = "Admin"\n\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("servers.group_mappings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v('\ngroup_dn = "'),a("span",{pre:!0,attrs:{class:"token important"}},[s._v('*"')]),s._v('\norg_role = "Viewer"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h3",{attrs:{id:"重启服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启服务"}},[s._v("#")]),s._v(" 重启服务")]),s._v(" "),a("p",[a("code",[s._v("sudo service grafana-server restart")])])])}),[],!1,null,null,null);a.default=e.exports}}]);