(window.webpackJsonp=window.webpackJsonp||[]).push([[177],{579:function(s,a,e){"use strict";e.r(a);var t=e(2),n=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"ansible-各大模块介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-各大模块介绍"}},[s._v("#")]),s._v(" ansible 各大模块介绍")]),s._v(" "),a("h3",{attrs:{id:"ping模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ping模块"}},[s._v("#")]),s._v(" ping模块")]),s._v(" "),a("p",[s._v("测试主机是否是通的，用法很简单，不涉及参数：\n"),a("code",[s._v("ansible test -m ping")])]),s._v(" "),a("h3",{attrs:{id:"setup模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup模块"}},[s._v("#")]),s._v(" setup模块")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("setup模块，主要用于获取主机信息，在playbooks里经常会用到的一个参数gather_facts就与该模块相关。setup模块下经常使用的一个参数是filter参数，具体使用示例如下：\n    ansible "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.212")]),s._v(".52.252 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" setup "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'filter=ansible_*_mb'")]),s._v("   //查看主机内存信息\n    ansible "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.212")]),s._v(".52.252 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" setup "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'filter=ansible_eth[0-2]'")]),s._v("   //查看地接口为eth0-2的网卡信息\n    ansible all "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" setup "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tree")]),s._v(" /tmp/facts   //将所有主机的信息输入到/tmp/facts目录下，每台主机的信息输入到主机名文件中（/etc/ansible/hosts里的主机名）\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"file模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#file模块"}},[s._v("#")]),s._v(" file模块")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("file模块主要用于远程主机上的文件操作，file模块包含如下选项：\nforce：需要在两种情况下强制创建软链接，一种是源文件不存在但之后会建立的情况下；另一种是目标软链接已存在,需要先取消之前的软链，然后创建新的软链，有两个选项：yes"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("no\ngroup：定义文件/目录的属组\nmode：定义文件/目录的权限\nowner：定义文件/目录的属主\npath：必选项，定义文件/目录的路径\nrecurse：递归的设置文件的属性，只对目录有效\nsrc：要被链接的源文件的路径，只应用于state"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("link的情况\ndest：被链接到的路径，只应用于state"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("link的情况\nstate：  \ndirectory：如果目录不存在，创建目录\nfile：即使文件不存在，也不会被创建\nlink：创建软链接\nhard：创建硬链接\ntouch：如果文件不存在，则会创建一个新的文件，如果文件或目录已存在，则更新其最后修改时间\nabsent：删除目录、文件或者取消链接文件\n使用示例：\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src=/etc/fstab dest=/tmp/fstab state=link"')]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path=/tmp/fstab state=absent"')]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path=/tmp/test state=touch"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"copy模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copy模块"}},[s._v("#")]),s._v(" copy模块")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("复制文件到远程主机，copy模块包含如下选项：\nbackup：在覆盖之前将原文件备份，备份文件包含时间信息。有两个选项：yes"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("no\ncontent：用于替代"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src"')]),s._v(",可以直接设定指定文件的值\ndest：必选项。要将源文件复制到的远程主机的绝对路径，如果源文件是一个目录，那么该路径也必须是个目录\ndirectory_mode：递归的设定目录的权限，默认为系统默认权限\nforce：如果目标主机包含该文件，但内容不同，如果设置为yes，则强制覆盖，如果为no，则只有当目标主机的目标位置不存在该文件时，才复制。默认为yes\nothers：所有的file模块里的选项都可以在这里使用\nsrc：要复制到远程主机的文件在本地的地址，可以是绝对路径，也可以是相对路径。如果路径是一个目录，它将递归复制。在这种情况下，如果路径使用"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')]),s._v("来结尾，则只复制目录里的内容，如果没有使用"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')]),s._v("来结尾，则包含目录在内的整个内容全部复制，类似于rsync。\nvalidate ：The validation "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" to run before copying into place. The path to the "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" to validate is passed "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" via "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%s'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" must be present as "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the visudo example below.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[a("strong",[s._v("示例如下")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" copy "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src=/srv/myfiles/foo.conf dest=/etc/foo.conf owner=foo group=foo mode=0644"')]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" copy "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src=/mine/ntp.conf dest=/etc/ntp.conf owner=root group=root mode=644 backup=yes"')]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" copy "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"src=/mine/sudoers dest=/etc/sudoers validate='visudo -cf %s'\"")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"service模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service模块"}},[s._v("#")]),s._v(" service模块")]),s._v(" "),a("blockquote",[a("p",[s._v("用于管理服务")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("该模块包含如下选项：\narguments：给命令行提供一些选项\nenabled：是否开机启动 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("no\nname：必选项，服务名称\npattern：定义一个模式，如果通过status指令来查看服务的状态时，没有响应，就会通过ps指令在进程中根据该模式进行查找，如果匹配到，则认为该服务依然在运行\nrunlevel：运行级别\nsleep：如果执行了restarted，在则stop和start之间沉睡几秒钟\nstate：对当前服务执行启动，停止、重启、重新加载等操作（started,stopped,restarted,reloaded）\n使用示例：\nansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name=httpd state=started enabled=yes"')]),s._v("\n    asnible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name=foo pattern=/usr/bin/foo state=started"')]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name=network state=restarted args=eth0"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h3",{attrs:{id:"cron模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cron模块"}},[s._v("#")]),s._v(" cron模块")]),s._v(" "),a("blockquote",[a("p",[s._v("用于管理计划任务包含如下选项：")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("backup：对远程主机上的原任务计划内容修改之前做备份\ncron_file：如果指定该选项，则用该文件替换远程主机上的cron.d目录下的用户的任务计划\nday：日（1-31，*，*/2,……）\nhour：小时（0-23，*，*/2，……）  \nminute：分钟（0-59，*，*/2，……）\nmonth：月（1-12，*，*/2，……）\nweekday：周（0-7，*，……）\njob：要执行的任务，依赖于state"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("present\nname：该任务的描述\nspecial_time：指定什么时候执行，参数：reboot,yearly,annually,monthly,weekly,daily,hourly\nstate：确认该任务计划是创建还是删除\nuser：以哪个用户的身份执行\n示例：\nansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'name="a job for reboot" special_time=reboot job="/some/job.sh"\'')]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'name="yum autoupdate" weekday="2" minute=0 hour=12 user="root\n    ansible test -m cron  -a \'')]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("backup")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"True"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("minute")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("hour")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5,2"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("job")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls -alh > /dev/null"')]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    ansilbe test -m cron -a '")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("cron_file")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ansible_yum-autoupdate "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("absent'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h3",{attrs:{id:"yum模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yum模块"}},[s._v("#")]),s._v(" yum模块")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("使用yum包管理器来管理软件包，其选项有：\nconfig_file：yum的配置文件\ndisable_gpg_check：关闭gpg_check\ndisablerepo：不启用某个源\nenablerepo：启用某个源\nname：要进行操作的软件包的名字，也可以传递一个url或者一个本地的rpm包的路径\nstate：状态（present，absent，latest）\n示例如下：\nansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=httpd state=latest'")]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=\"@Development tools\" state=present'")]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=http://nginx.org/packages/centos/6/noarch/RPMS/nginx-release-centos-6-0.el6.ngx.noarch.rpm state=present'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"user模块与group模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#user模块与group模块"}},[s._v("#")]),s._v(" user模块与group模块")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("user模块是请求的是useradd, userdel, usermod三个指令，goup模块请求的是groupadd, groupdel, "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupmod")]),s._v(" 三个指令。\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、user模块\nhome：指定用户的家目录，需要与createhome配合使用\ngroups：指定用户的属组\nuid：指定用的uid\npassword：指定用户的密码\nname：指定用户名\ncreatehome：是否创建家目录 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("no\nsystem：是否为系统用户\nremove：当state"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("absent时，remove"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes则表示连同家目录一起删除，等价于userdel "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v("\nstate：是创建还是删除\nshell：指定用户的shell环境\n使用示例：\n    user: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("johnd "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("comment")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"John Doe"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1040")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("group")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin\n    user: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("james "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("shell")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/bin/bash "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admins,developers "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("append")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes user: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("johnd "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("absent "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("remove")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\n    user: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("james18 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("shell")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/bin/zsh "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("developers "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("expires")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1422403387")]),s._v("\n    user: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("generate_ssh_key")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ssh_key_bits")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ssh_key_file")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".ssh/id_rsa    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#生成密钥时，只会生成公钥文件和私钥文件，和直接使用ssh-keygen指令效果相同，不会生成authorized_keys文件。")]),s._v("\n注：指定password参数时，不能使用明文密码，因为后面这一串密码会被直接传送到被管理主机的/etc/shadow文件中，所以需要先将密码字符串进行加密处理。然后将得到的字符串放到password中即可。\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" openssl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-salt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /dev/urandom "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tr")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-dc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[:alnum:]'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-stdin")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$4P4PlFuE")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ur9ObJiT5iHNrb9QnjaIB0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("blockquote",[a("p",[s._v("使用上面的密码创建用户")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ansible all "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=foo password=\"$1$4P4PlFuE$ur9ObJiT5iHNrb9QnjaIB0\"'")]),s._v("\n不同的发行版默认使用的加密方式可能会有区别，具体可以查看/etc/login.defs文件确认，centos "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.5")]),s._v("版本使用的是SHA512加密算法。\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、group示例\nansible all "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" group "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=somegroup state=present'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"synchronize模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#synchronize模块"}},[s._v("#")]),s._v(" synchronize模块")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("使用rsync同步文件，其参数如下：\narchive: 归档，相当于同时开启recursive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("递归"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("、links、perms、times、owner、group、-D选项都为yes ，默认该项为开启\nchecksum: 跳过检测sum值，默认关闭\ncompress:是否开启压缩\ncopy_links：复制链接文件，默认为no ，注意后面还有一个links参数\ndelete: 删除不存在的文件，默认no\ndest：目录路径\ndest_port：默认目录主机上的端口 ，默认是22，走的ssh协议\ndirs：传速目录不进行递归，默认为no，即进行目录递归\nrsync_opts：rsync参数部分\nset_remote_user：主要用于/etc/ansible/hosts中定义或默认使用的用户与rsync使用的用户不同的情况\nmode: push或pull 模块，push模的话，一般用于从本机向远程主机上传文件，pull 模式用于从远程主机上取文件\n使用示例：\n    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("some/relative/path "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/some/absolute/path "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rsync_path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sudo rsync"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("some/relative/path "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/some/absolute/path "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("archive")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("no "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("links")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\n    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("some/relative/path "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/some/absolute/path "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("checksum")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("no\n    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/helloworld "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/www/helloword "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rsync_opts")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("--no-motd,--exclude"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".git "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("mode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pull\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h3",{attrs:{id:"filesystem模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#filesystem模块"}},[s._v("#")]),s._v(" filesystem模块")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("在块设备上创建文件系统\n选项：\ndev：目标块设备\nforce：在一个已有文件系统 的设备上强制创建\nfstype：文件系统的类型\nopts：传递给mkfs命令的选项\n示例：\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" filesystem "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fstype=ext2 dev=/dev/sdb1 force=yes'")]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" filesystem "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fstype=ext4 dev=/dev/sdb1 opts=\"-cc\"'")]),s._v("\n十一、mount模块\n配置挂载点\n选项：\ndump\nfstype：必选项，挂载文件的类型\nname：必选项，挂载点\nopts：传递给mount命令的参数\nsrc：必选项，要挂载的文件\nstate：必选项\npresent：只处理fstab中的配置\nabsent：删除挂载点\nmounted：自动创建挂载点并挂载之\numounted：卸载\n示例：\n    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/mnt/dvd "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/sr0 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("fstype")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("iso9660 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("opts")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ro "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("present\n    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/srv/disk "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'LABEL=SOME_LABEL'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("present\n    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'UUID=b3e48f45-f933-4c8e-a700-22a159ec9077'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("opts")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("noatime "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("present\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dd if=/dev/zero of=/disk.img bs=4k count=1024'")]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'losetup /dev/loop0 /disk.img'")]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" filesystem "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fstype=ext4 force=yes opts=-F dev=/dev/loop0'")]),s._v("\n    ansible "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=/mnt src=/dev/loop0 fstype=ext4 state=mounted opts=rw'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("h3",{attrs:{id:"get-url-模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-url-模块"}},[s._v("#")]),s._v(" "),a("code",[s._v("get_url")]),s._v(" 模块")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("该模块主要用于从http、ftp、https服务器上下载文件（类似于wget），主要有如下选项：\nsha256sum：下载完成后进行sha256 check；\ntimeout：下载超时时间，默认10s\nurl：下载的URL\nurl_password、url_username：主要用于需要用户名密码进行验证的情况\nuse_proxy：是事使用代理，代理需事先在环境变更中定义\n示例：\n    get_url: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("url")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://example.com/path/file.conf "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/foo.conf "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("mode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0440\n    get_url: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("url")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://example.com/path/file.conf "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/foo.conf "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sha256sum")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b5bb9d8014a0f9b1d61e21e796d78dccdf1352f23cd32812f4850b878ae4944c\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"unarchive模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#unarchive模块"}},[s._v("#")]),s._v(" unarchive模块")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("用于解压文件，模块包含如下选项：\ncopy：在解压文件之前，是否先将文件复制到远程主机，默认为yes。若为no，则要求目标主机上压缩包必须存在。\ncreates：指定一个文件名，当该文件存在时，则解压指令不执行\ndest：远程主机上的一个路径，即文件解压的路径\ngrop：解压后的目录或文件的属组\nlist_files：如果为yes，则会列出压缩包里的文件，默认为no，2.0版本新增的选项\nmode：解决后文件的权限\nsrc：如果copy为yes，则需要指定压缩文件的源路径\nowner：解压后文件或目录的属主\n示例如下：\n- unarchive: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("foo.tgz "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/foo\n- unarchive: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/foo.zip "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/bin "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("copy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("no\n- unarchive: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://example.com/example.zip "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/bin "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("copy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("no\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);