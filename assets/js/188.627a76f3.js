(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{594:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"什么是系统平均负载-load-average"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是系统平均负载-load-average"}},[s._v("#")]),s._v(" 什么是系统平均负载(Load average)？")]),s._v(" "),t("p",[s._v("在"),t("code",[s._v("Linux")]),s._v("系统中，"),t("code",[s._v("uptime")]),s._v("、"),t("code",[s._v("w")]),s._v("、"),t("code",[s._v("top")]),s._v("等命令都会有系统平均负载"),t("code",[s._v("load average")]),s._v("的输出，那么什么是系统平均负载呢？")]),s._v(" "),t("blockquote",[t("p",[s._v("系统平均负载被定义为在特定时间间隔内运行队列中的平均进程数。如果一个进程满足以下条件则其就会位于运行队列中：")])]),s._v(" "),t("ul",[t("li",[s._v("它没有在等待I/O操作的结果")]),s._v(" "),t("li",[s._v("它没有主动进入等待状态(也就是没有调用'"),t("code",[s._v("wait")]),s._v("')")]),s._v(" "),t("li",[s._v("没有被停止(例如：等待终止)")])]),s._v(" "),t("p",[t("strong",[s._v("例如：")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("　　"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@opendigest root"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uptime")]),s._v("\n　　"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(":51pm up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" days, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(":43, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" users, load average: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.13")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.90")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.94")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("命令输出的最后内容表示在过去的"),t("code",[s._v("1、5、15")]),s._v("分钟内运行队列中的平均进程数量。")]),s._v(" "),t("blockquote",[t("p",[s._v("一般来说只要每个"),t("code",[s._v("CPU")]),s._v("的当前活动进程数不大于3那么系统的性能就是良好的，如果每个CPU的任务数大于5，那么就表示这台机器的性能有严重问题。对于 上面的例子来说，假设系统有两个CPU，那么其每个CPU的当前任务数为：8.13/2=4.065。这表示该系统的性能是可以接受的。")])]),s._v(" "),t("h2",{attrs:{id:"load-average的算法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#load-average的算法"}},[s._v("#")]),s._v(" Load average的算法")]),s._v(" "),t("p",[s._v("上面的输出数据是每隔5秒钟检查一次活跃的进程数，然后根据这个数值算出来的。如果这个数除以CPU的数目，结果高于5的时候就表明系统在超负荷运转了。其算法(摘自Linux 2.4的内核代码)如下：")]),s._v(" "),t("p",[s._v("文件: "),t("code",[s._v("include/linux/sched.h")]),s._v(":")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("FSHIFT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" ")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* nr of bits of precision */")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("FIXED_1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("#define "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("LOAD_FREQ")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("HZ"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* 5 sec intervals */")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("EXP_1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1884")]),s._v(" ")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* 1/exp(5sec/1min) as fixed-point, 2048/pow(exp(1), 5.0/60) */")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("EXP_5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v(" ")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* 1/exp(5sec/5min), 2048/pow(exp(1), 5.0/300) */")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("EXP_15")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2037")]),s._v(" ")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* 1/exp(5sec/15min), 2048/pow(exp(1), 5.0/900) */")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name function"}},[s._v("CALC_LOAD")]),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("load"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("exp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("load "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*=")]),s._v(" exp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" ")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("load "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FIXED_1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("exp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" ")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("load "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>=")]),s._v(" FSHIFT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**********************************************************/")]),s._v("\n文件"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" kernel"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("timer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" avenrun"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("inline")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("calc_load")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" ticks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" active_tasks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* fixed-point */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" count "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" LOAD_FREQ"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    count "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-=")]),s._v(" ticks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    count "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" LOAD_FREQ"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    active_tasks "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("count_active_tasks")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("CALC_LOAD")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("avenrun"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" EXP_1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" active_tasks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("CALC_LOAD")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("avenrun"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" EXP_5"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" active_tasks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("CALC_LOAD")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("avenrun"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" EXP_15"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" active_tasks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**********************************************************/")]),s._v("\n文件"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" fs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("proc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("proc_misc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name function"}},[s._v("LOAD_INT")]),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" FSHIFT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name function"}},[s._v("LOAD_FRAC")]),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("LOAD_INT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FIXED_1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("loadavg_read_proc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("page"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("off_t")]),s._v(" off"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" count"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("eof"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" len"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avenrun"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FIXED_1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    b "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avenrun"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FIXED_1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avenrun"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FIXED_1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    len "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sprintf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("page"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%d.d %d.d %d.d %ld/%d %d "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("LOAD_INT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("LOAD_FRAC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("LOAD_INT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("LOAD_FRAC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("LOAD_INT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("LOAD_FRAC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nr_running")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" nr_threads"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" last_pid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("proc_calc_metrics")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("page"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" off"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" count"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" eof"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" len"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br")])]),t("h2",{attrs:{id:"proc-loadavg-各项数据的含义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#proc-loadavg-各项数据的含义"}},[s._v("#")]),s._v(" "),t("code",[s._v("/proc/loadavg")]),s._v(" 各项数据的含义")]),s._v(" "),t("p",[t("code",[s._v("/proc")]),s._v("文件系统是一个虚拟的文件系统，不占用磁盘空间，它反映了当前操作系统在内存中的运行情况，查看"),t("code",[s._v("/proc")]),s._v("下的文件可以聊寄到系统的运行状态。查看系统平均负载使用"),t("code",[s._v("cat /proc/loadavg")]),s._v("命令，输出结果如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.27")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.36")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.37")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("/83 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4828")]),s._v("/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("前三个数字大家都知道，是1、5、15分钟内的平均进程数（有人认为是系统负荷的百分比，其实不然，有些时候可以看到200甚至更多）。后面两个呢，一个的分子是正在运行的进程数，分母是进程总数；另一个是最近运行的进程ID号。")]),s._v(" "),t("h2",{attrs:{id:"查看系统平均负载的常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看系统平均负载的常用命令"}},[s._v("#")]),s._v(" 查看系统平均负载的常用命令")]),s._v(" "),t("ol",[t("li",[t("p",[t("code",[s._v("cat /proc/loadavg")])])]),s._v(" "),t("li",[t("p",[t("code",[s._v("uptime")])])])]),s._v(" "),t("ul",[t("li",[s._v("名称： "),t("code",[s._v("uptime")])]),s._v(" "),t("li",[s._v("使用权限： "),t("code",[s._v("所有使用者")])]),s._v(" "),t("li",[s._v("使用方式： "),t("code",[s._v("uptime [-V]")])]),s._v(" "),t("li",[s._v("说明： "),t("code",[s._v("uptime")]),s._v("提供使用者下面的资讯，不需其他参数：")])]),s._v(" "),t("p",[s._v("现在的时间 系统开机运转到现在经过的时间 连线的使用者数量 最近一分钟，五分钟和十五分钟的系统负载")]),s._v(" "),t("ul",[t("li",[s._v("参数： "),t("code",[s._v("-V")]),s._v(" 显示版本资讯。")])]),s._v(" "),t("p",[s._v("范例： "),t("code",[s._v("uptime")]),s._v(" "),t("strong",[s._v("其结果为")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":41am up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" days, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" min, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" users, load average: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.99")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[t("code",[s._v("w")])])]),s._v(" "),t("p",[s._v("功能说明：显示目前登入系统的用户信息。")]),s._v(" "),t("p",[s._v("语　　法：w [-fhlsuV][用户名称]")]),s._v(" "),t("p",[s._v("补充说明：执行这项指令可得知目前登入系统的用户有那些人，以及他们正在执行的程序。单独执行w\n指令会显示所有的用户，您也可指定用户名称，仅显示某位用户的相关信息。")]),s._v(" "),t("p",[t("strong",[s._v("参　　数")]),s._v("：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-f")]),s._v(" 　开启或关闭显示用户从何处登入系统。")]),s._v(" "),t("li",[t("code",[s._v("-h")]),s._v(" 　不显示各栏位的标题信息列。")]),s._v(" "),t("li",[t("code",[s._v("-l")]),s._v(" 　使用详细格式列表，此为预设值。")]),s._v(" "),t("li",[t("code",[s._v("-s")]),s._v(" 　使用简洁格式列表，不显示用户登入时间，终端机阶段作业和程序所耗费的CPU时间。")]),s._v(" "),t("li",[t("code",[s._v("-u")]),s._v(" 　忽略执行程序的名称，以及该程序耗费CPU时间的信息。")]),s._v(" "),t("li",[t("code",[s._v("-V")]),s._v(" 　显示版本信息。")])]),s._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[t("code",[s._v("top")])])]),s._v(" "),t("p",[s._v("功能说明：显示，管理执行中的程序。\n语　　法：top [bciqsS][d <间隔秒数>][n <执行次数>]\n补充说明：执行top指令可显示目前正在系统中执行的程序，并通过它所提供的互动式界面，用热键加以管理。\n参　　数：")]),s._v(" "),t("ul",[t("li",[s._v("-"),t("code",[s._v("b")]),s._v(" 　使用批处理模式。")]),s._v(" "),t("li",[s._v("-"),t("code",[s._v("c")]),s._v(" 　列出程序时，显示每个程序的完整指令，包括指令名称，路径和参数等相关信息。")]),s._v(" "),t("li",[s._v("-"),t("code",[s._v("d")]),s._v("<间隔秒数> 　设置top监控程序执行状况的间隔时间，单位以秒计算。")]),s._v(" "),t("li",[s._v("-"),t("code",[s._v("i")]),s._v(" 　执行top指令时，忽略闲置或是已成为Zombie的程序。")]),s._v(" "),t("li",[s._v("-"),t("code",[s._v("n")]),s._v("<执行次数> 　设置监控信息的更新次数。")]),s._v(" "),t("li",[s._v("-"),t("code",[s._v("q")]),s._v(" 　持续监控程序执行的状况。")]),s._v(" "),t("li",[s._v("-"),t("code",[s._v("s")]),s._v(" 　使用保密模式，消除互动模式下的潜在危机。")]),s._v(" "),t("li",[s._v("-"),t("code",[s._v("S")]),s._v(' 　使用累计模式，其效果类似ps指令的"-S"参数。')])]),s._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[t("code",[s._v("tload")])])]),s._v(" "),t("p",[t("strong",[s._v("功能说明：")]),s._v(" 显示系统负载状况。")]),s._v(" "),t("p",[t("strong",[s._v("语　　法：")]),s._v(" "),t("code",[s._v("tload")]),s._v(" [-V][-d <间隔秒数>][-s <刻度大小>][终端机编号]")]),s._v(" "),t("p",[t("strong",[s._v("补充说明：")]),s._v(" "),t("code",[s._v("tload")]),s._v("指令使用"),t("code",[s._v("ASCII")]),s._v("字符简单地以文字模式显示系统负载状态。假设不给予终端机编号，则会在执行"),t("code",[s._v("tload")]),s._v("指令的终端机显示负载情形。")]),s._v(" "),t("p",[t("strong",[s._v("参　　数：")])]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-d<间隔秒数>")]),s._v("　设置tload检测系统负载的间隔时间，单位以秒计算。")]),s._v(" "),t("li",[t("code",[s._v("-s<刻度大小>")]),s._v(" 　设置图表的垂直刻度大小，单位以列计算。")]),s._v(" "),t("li",[t("code",[s._v("-V")]),s._v(" 　显示版本信息。")])])])}),[],!1,null,null,null);t.default=e.exports}}]);