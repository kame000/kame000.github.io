(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{518:function(s,_,v){"use strict";v.r(_);var t=v(2),e=Object(t.a)({},(function(){var s=this,_=s._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[_("h2",{attrs:{id:"redis基本操作"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#redis基本操作"}},[s._v("#")]),s._v(" redis基本操作")]),s._v(" "),_("h2",{attrs:{id:"_1-预备知识"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-预备知识"}},[s._v("#")]),s._v(" 1. 预备知识")]),s._v(" "),_("p",[s._v("在介绍 "),_("code",[s._v("5")]),s._v(" 种 "),_("strong",[s._v("数据结构")]),s._v(" 之前，需要先了解 "),_("code",[s._v("Redis")]),s._v(" 的一些 "),_("strong",[s._v("全局命令")]),s._v("、"),_("strong",[s._v("数据结构")]),s._v(" 和 "),_("strong",[s._v("内部编码")]),s._v("、"),_("strong",[s._v("单线程命令处理机制")]),s._v("。")]),s._v(" "),_("ol",[_("li",[_("code",[s._v("Redis")]),s._v(" 的命令有 "),_("strong",[s._v("上百个")]),s._v("，理解 "),_("code",[s._v("Redis")]),s._v(" 的一些机制，会发现这些命令有很强的 "),_("strong",[s._v("通用性")]),s._v("。")]),s._v(" "),_("li",[_("code",[s._v("Redis")]),s._v(" 不是万金油，有些 "),_("strong",[s._v("数据结构")]),s._v(" 和 "),_("strong",[s._v("命令")]),s._v(" 必须在 "),_("strong",[s._v("特定场景")]),s._v(" 下使用，一旦 "),_("strong",[s._v("使用不当")]),s._v(" 可能对 "),_("code",[s._v("Redis")]),s._v(" "),_("strong",[s._v("本身")]),s._v(" 或者 "),_("strong",[s._v("应用本身")]),s._v(" 造成致命伤害。")])]),s._v(" "),_("h2",{attrs:{id:"_2-全局命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-全局命令"}},[s._v("#")]),s._v(" 2. 全局命令")]),s._v(" "),_("p",[_("code",[s._v("Redis")]),s._v(" 有 "),_("code",[s._v("5")]),s._v(" 种 "),_("strong",[s._v("数据结构")]),s._v("，它们是 "),_("strong",[s._v("键值对")]),s._v(" 中的 "),_("strong",[s._v("值")]),s._v("，对于 "),_("strong",[s._v("键")]),s._v(" 来说有一些通用的命令。")]),s._v(" "),_("h3",{attrs:{id:"_2-1-查看所有键"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-查看所有键"}},[s._v("#")]),s._v(" 2.1. 查看所有键")]),s._v(" "),_("blockquote",[_("p",[s._v("keys *")])]),s._v(" "),_("p",[s._v("下面插入了 "),_("code",[s._v("3")]),s._v(" 对字符串类型的键值对：")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("127.0.0.1:6379> set hello world\nOK\n127.0.0.1:6379> set java jedis\nOK\n127.0.0.1:6379> set python redis-py\nOK\n复制代码\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br"),_("span",{staticClass:"line-number"},[s._v("5")]),_("br"),_("span",{staticClass:"line-number"},[s._v("6")]),_("br"),_("span",{staticClass:"line-number"},[s._v("7")]),_("br")])]),_("p",[s._v("命令会将所有的键输出：")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v('127.0.0.1:6379> keys *\n1) "python"\n2) "java"\n3) "hello"\n复制代码\n')])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br"),_("span",{staticClass:"line-number"},[s._v("5")]),_("br")])]),_("h3",{attrs:{id:"_2-2-键总数"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-键总数"}},[s._v("#")]),s._v(" 2.2. 键总数")]),s._v(" "),_("blockquote",[_("p",[s._v("dbsize")])]),s._v(" "),_("p",[s._v("下面插入一个 "),_("strong",[s._v("列表类型")]),s._v(" 的 "),_("strong",[s._v("键值对")]),s._v("（值是 "),_("strong",[s._v("多个元素")]),s._v(" 组成）：")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("127.0.0.1:6379> rpush mylist a b c d e f g\n(integer) 7\n复制代码\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br")])]),_("p",[_("code",[s._v("dbsize")]),s._v(" 命令会返回当前数据库中 "),_("strong",[s._v("键的总数")]),s._v("。")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("127.0.0.1:6379> dbsize\n(integer) 4\n复制代码\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br")])]),_("p",[_("code",[s._v("dbsize")]),s._v(" 命令在 "),_("strong",[s._v("计算键总数")]),s._v(" 时 "),_("strong",[s._v("不会遍历")]),s._v(" 所有键，而是直接获取 "),_("code",[s._v("Redis")]),s._v(" "),_("strong",[s._v("内置的键总数变量")]),s._v("，所以 "),_("code",[s._v("dbsize")]),s._v(" 命令的 "),_("strong",[s._v("时间复杂度")]),s._v(" 是 "),_("code",[s._v("O（1）")]),s._v("。而 "),_("code",[s._v("keys")]),s._v(" 命令会 "),_("strong",[s._v("遍历")]),s._v(" 所有键，所以它的 "),_("strong",[s._v("时间复杂度")]),s._v(" 是 "),_("code",[s._v("O（n）")]),s._v("，当 "),_("code",[s._v("Redis")]),s._v(" 保存了 "),_("strong",[s._v("大量键")]),s._v(" 时，线上环境 "),_("strong",[s._v("禁止")]),s._v(" 使用。")]),s._v(" "),_("h3",{attrs:{id:"_2-3-检查键是否存在"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-检查键是否存在"}},[s._v("#")]),s._v(" 2.3. 检查键是否存在")]),s._v(" "),_("blockquote",[_("p",[s._v("exists key")])]),s._v(" "),_("p",[s._v("如果键存在则返回 "),_("code",[s._v("1")]),s._v("，不存在则返回 "),_("code",[s._v("0")]),s._v("：")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("127.0.0.1:6379> exists java\n(integer) 1\n127.0.0.1:6379> exists not_exist_key\n(integer) 0\n复制代码\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br"),_("span",{staticClass:"line-number"},[s._v("5")]),_("br")])]),_("h3",{attrs:{id:"_2-4-删除键"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-删除键"}},[s._v("#")]),s._v(" 2.4. 删除键")]),s._v(" "),_("blockquote",[_("p",[s._v("del key")])]),s._v(" "),_("p",[_("code",[s._v("del")]),s._v(" 是一个 "),_("strong",[s._v("通用命令")]),s._v("，无论值是什么 "),_("strong",[s._v("数据结构")]),s._v(" 类型，"),_("code",[s._v("del")]),s._v(" 命令都可以将其 "),_("strong",[s._v("删除")]),s._v("。")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("127.0.0.1:6379> del java\n(integer) 1\n127.0.0.1:6379> exists java\n(integer) 0\n127.0.0.1:6379> del not_exist_key\n(integer) 0\n127.0.0.1:6379> exists not_exist_key\n(integer) 0\n复制代码\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br"),_("span",{staticClass:"line-number"},[s._v("5")]),_("br"),_("span",{staticClass:"line-number"},[s._v("6")]),_("br"),_("span",{staticClass:"line-number"},[s._v("7")]),_("br"),_("span",{staticClass:"line-number"},[s._v("8")]),_("br"),_("span",{staticClass:"line-number"},[s._v("9")]),_("br")])]),_("p",[s._v("返回结果为 "),_("strong",[s._v("成功删除")]),s._v(" 的 "),_("strong",[s._v("键的个数")]),s._v("，假设删除一个 "),_("strong",[s._v("不存在")]),s._v(" 的键，就会返回 "),_("code",[s._v("0")]),s._v("。")]),s._v(" "),_("h3",{attrs:{id:"_2-5-键过期"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-键过期"}},[s._v("#")]),s._v(" 2.5. 键过期")]),s._v(" "),_("blockquote",[_("p",[s._v("expire key seconds")])]),s._v(" "),_("p",[_("code",[s._v("Redis")]),s._v(" 支持对 "),_("strong",[s._v("键")]),s._v(" 添加 "),_("strong",[s._v("过期时间")]),s._v("，当超过过期时间后，会 "),_("strong",[s._v("自动删除键")]),s._v("，例如为键 "),_("code",[s._v("hello")]),s._v(" 设置 "),_("code",[s._v("10")]),s._v(" 秒过期时间：")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("127.0.0.1:6379> set hello world\nOK\n127.0.0.1:6379> expire hello 10 \n(integer) 0\n复制代码\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br"),_("span",{staticClass:"line-number"},[s._v("5")]),_("br")])]),_("p",[_("code",[s._v("ttl")]),s._v(" 命令会返回键的 "),_("strong",[s._v("剩余过期时间")]),s._v("，它有 "),_("code",[s._v("3")]),s._v(" 种返回值：")]),s._v(" "),_("ul",[_("li",[s._v("大于等于 "),_("code",[s._v("0")]),s._v(" 的整数：表示键 "),_("strong",[s._v("剩余")]),s._v(" 的 "),_("strong",[s._v("过期时间")]),s._v("。")]),s._v(" "),_("li",[s._v("返回 "),_("code",[s._v("-1")]),s._v("："),_("strong",[s._v("键")]),s._v(" 没设置 "),_("strong",[s._v("过期时间")]),s._v("。")]),s._v(" "),_("li",[s._v("返回 "),_("code",[s._v("-2")]),s._v("："),_("strong",[s._v("键")]),s._v(" 不存在。")])]),s._v(" "),_("p",[s._v("可以通过 "),_("code",[s._v("ttl")]),s._v(" 命令观察 "),_("strong",[s._v("键")]),s._v(" "),_("code",[s._v("hello")]),s._v(" 的 "),_("strong",[s._v("剩余过期时间")]),s._v("：")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("# 还剩7秒\n127.0.0.1:6379> ttl hello(integer) \n(integer) 7\n...\n# 还剩1秒\n127.0.0.1:6379> ttl hello(integer) \n(integer) 1\n# 返回结果为-2，说明键hello已经被删除\n127.0.0.1:6379> ttl hello(integer) \n(integer) -2\n127.0.0.1:6379> get hello\n(nil)\n复制代码\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br"),_("span",{staticClass:"line-number"},[s._v("5")]),_("br"),_("span",{staticClass:"line-number"},[s._v("6")]),_("br"),_("span",{staticClass:"line-number"},[s._v("7")]),_("br"),_("span",{staticClass:"line-number"},[s._v("8")]),_("br"),_("span",{staticClass:"line-number"},[s._v("9")]),_("br"),_("span",{staticClass:"line-number"},[s._v("10")]),_("br"),_("span",{staticClass:"line-number"},[s._v("11")]),_("br"),_("span",{staticClass:"line-number"},[s._v("12")]),_("br"),_("span",{staticClass:"line-number"},[s._v("13")]),_("br")])]),_("h3",{attrs:{id:"_2-6-键的数据结构类型"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-键的数据结构类型"}},[s._v("#")]),s._v(" 2.6. 键的数据结构类型")]),s._v(" "),_("blockquote",[_("p",[s._v("type key")])]),s._v(" "),_("p",[s._v("例如键 "),_("code",[s._v("hello")]),s._v(" 是的值 "),_("strong",[s._v("字符串类型")]),s._v("，返回结果为 "),_("code",[s._v("string")]),s._v("。键 "),_("code",[s._v("mylist")]),s._v(" 的值是 "),_("strong",[s._v("列表类型")]),s._v("，返回结果为 "),_("code",[s._v("list")]),s._v("。如果键不存在，则返回 "),_("code",[s._v("none")]),s._v("。")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v("127.0.0.1:6379> set a b\nOK\n127.0.0.1:6379> type a\nstring\n127.0.0.1:6379> rpush mylist a b c d e f g\n(integer) 7\n127.0.0.1:6379> type mylist\nlist\n复制代码\n")])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br"),_("span",{staticClass:"line-number"},[s._v("5")]),_("br"),_("span",{staticClass:"line-number"},[s._v("6")]),_("br"),_("span",{staticClass:"line-number"},[s._v("7")]),_("br"),_("span",{staticClass:"line-number"},[s._v("8")]),_("br"),_("span",{staticClass:"line-number"},[s._v("9")]),_("br")])]),_("h2",{attrs:{id:"_3-数据结构和内部编码"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-数据结构和内部编码"}},[s._v("#")]),s._v(" 3. 数据结构和内部编码")]),s._v(" "),_("p",[_("code",[s._v("type")]),s._v(" 命令实际返回的就是当前 "),_("strong",[s._v("键")]),s._v(" 的 "),_("strong",[s._v("数据结构类型")]),s._v("，它们分别是："),_("code",[s._v("string")]),s._v("（"),_("strong",[s._v("字符串")]),s._v("）、"),_("code",[s._v("hash")]),s._v("（"),_("strong",[s._v("哈希")]),s._v("）、"),_("code",[s._v("list")]),s._v("（"),_("strong",[s._v("列表")]),s._v("）、"),_("code",[s._v("set")]),s._v("（"),_("strong",[s._v("集合")]),s._v("）、"),_("code",[s._v("zset")]),s._v("（"),_("strong",[s._v("有序集合")]),s._v("），但这些只是 "),_("code",[s._v("Redis")]),s._v(" 对外的 "),_("strong",[s._v("数据结构")]),s._v("。如图所示：")]),s._v(" "),_("p",[_("img",{attrs:{src:"http://img.sharkyun.com/blog/2019-07-19-001345.png",alt:"img"}})]),s._v(" "),_("p",[s._v("对于每种 "),_("strong",[s._v("数据结构")]),s._v("，实际上都有自己底层的 "),_("strong",[s._v("内部编码")]),s._v(" 实现，而且是 "),_("strong",[s._v("多种实现")]),s._v("。这样 "),_("code",[s._v("Redis")]),s._v(" 会在合适的 "),_("strong",[s._v("场景")]),s._v(" 选择合适的 "),_("strong",[s._v("内部编码")]),s._v("，如图所示：")]),s._v(" "),_("p",[_("img",{attrs:{src:"http://img.sharkyun.com/blog/2019-07-19-001359.png",alt:"img"}})]),s._v(" "),_("p",[s._v("可以看到，每种 "),_("strong",[s._v("数据结构")]),s._v(" 都有 "),_("strong",[s._v("两种以上")]),s._v(" 的 "),_("strong",[s._v("内部编码实现")]),s._v("。例如 "),_("code",[s._v("list")]),s._v(" "),_("strong",[s._v("数据结构")]),s._v(" 包含了 "),_("code",[s._v("linkedlist")]),s._v(" 和 "),_("code",[s._v("ziplist")]),s._v(" 两种 "),_("strong",[s._v("内部编码")]),s._v("。同时有些 "),_("strong",[s._v("内部编码")]),s._v("，例如 "),_("code",[s._v("ziplist")]),s._v("，可以作为 "),_("strong",[s._v("多种外部数据结构")]),s._v(" 的内部实现，可以通过 "),_("code",[s._v("object encoding")]),s._v(" 命令查询 "),_("strong",[s._v("内部编码")]),s._v("：")]),s._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[s._v('127.0.0.1:6379> object encoding hello\n"embstr"\n127.0.0.1:6379> object encoding mylist\n"quicklist"\n复制代码\n')])]),s._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[s._v("1")]),_("br"),_("span",{staticClass:"line-number"},[s._v("2")]),_("br"),_("span",{staticClass:"line-number"},[s._v("3")]),_("br"),_("span",{staticClass:"line-number"},[s._v("4")]),_("br"),_("span",{staticClass:"line-number"},[s._v("5")]),_("br")])]),_("p",[s._v("可以看到键 "),_("code",[s._v("hello")]),s._v(" 对应值的 "),_("strong",[s._v("内部编码")]),s._v(" 是 "),_("code",[s._v("embstr")]),s._v("，键 "),_("code",[s._v("mylist")]),s._v(" 对应值的 "),_("strong",[s._v("内部编码")]),s._v(" 是 "),_("code",[s._v("ziplist")]),s._v("。")]),s._v(" "),_("p",[_("code",[s._v("Redis")]),s._v(" 这样设计有两个好处：")]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("其一")]),s._v("：可以改进 "),_("strong",[s._v("内部编码")]),s._v("，而对外的 "),_("strong",[s._v("数据结构")]),s._v(" 和 "),_("strong",[s._v("命令")]),s._v(" 没有影响。例如 "),_("code",[s._v("Redis3.2")]),s._v(" 提供的 "),_("code",[s._v("quicklist")]),s._v("，结合了 "),_("code",[s._v("ziplist")]),s._v(" 和 "),_("code",[s._v("linkedlist")]),s._v(" 两者的优势，为 "),_("strong",[s._v("列表类型")]),s._v(" 提供了一种 "),_("strong",[s._v("更加高效")]),s._v(" 的 "),_("strong",[s._v("内部编码实现")]),s._v("。")]),s._v(" "),_("li",[_("strong",[s._v("其二")]),s._v("：不同 "),_("strong",[s._v("内部编码")]),s._v(" 可以在 "),_("strong",[s._v("不同场景")]),s._v(" 下发挥各自的 "),_("strong",[s._v("优势")]),s._v("。例如 "),_("code",[s._v("ziplist")]),s._v(" 比较 "),_("strong",[s._v("节省内存")]),s._v("，但是在列表 "),_("strong",[s._v("元素比较多")]),s._v(" 的情况下，"),_("strong",[s._v("性能")]),s._v(" 会有所 "),_("strong",[s._v("下降")]),s._v("，这时候 "),_("code",[s._v("Redis")]),s._v(" 会根据 "),_("strong",[s._v("配置")]),s._v("，将列表类型的 "),_("strong",[s._v("内部实现")]),s._v(" 转换为 "),_("code",[s._v("linkedlist")]),s._v("。")])]),s._v(" "),_("h2",{attrs:{id:"_4-单线程架构"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-单线程架构"}},[s._v("#")]),s._v(" 4. 单线程架构")]),s._v(" "),_("p",[_("code",[s._v("Redis")]),s._v(" 使用了 "),_("strong",[s._v("单线程架构")]),s._v(" 和 "),_("code",[s._v("I/O")]),s._v(" "),_("strong",[s._v("多路复用模型")]),s._v(" 来实现 "),_("strong",[s._v("高性能")]),s._v(" 的 "),_("strong",[s._v("内存数据库服务")]),s._v("。那为什么 "),_("strong",[s._v("单线程")]),s._v(" 还能这么快，下面分析原因：")]),s._v(" "),_("h3",{attrs:{id:"_4-1-纯内存访问"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-纯内存访问"}},[s._v("#")]),s._v(" 4.1. 纯内存访问")]),s._v(" "),_("p",[_("code",[s._v("Redis")]),s._v(" 将所有数据放在 "),_("strong",[s._v("内存")]),s._v(" 中，内存的 "),_("strong",[s._v("响应时长")]),s._v(" 大约为 "),_("code",[s._v("100")]),s._v(" "),_("strong",[s._v("纳秒")]),s._v("，这是 "),_("code",[s._v("Redis")]),s._v(" 达到 "),_("strong",[s._v("每秒万级别")]),s._v(" 访问的重要基础。")]),s._v(" "),_("h3",{attrs:{id:"_4-2-非阻塞i-o"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-非阻塞i-o"}},[s._v("#")]),s._v(" 4.2. 非阻塞I/O")]),s._v(" "),_("p",[_("code",[s._v("Redis")]),s._v(" 使用 "),_("code",[s._v("epoll")]),s._v(" 作为 "),_("code",[s._v("I/O")]),s._v(" "),_("strong",[s._v("多路复用技术")]),s._v(" 的实现，再加上 "),_("code",[s._v("Redis")]),s._v(" 自身的 "),_("strong",[s._v("事件处理模型")]),s._v(" 将 "),_("code",[s._v("epoll")]),s._v(" 中的 "),_("strong",[s._v("连接")]),s._v("、"),_("strong",[s._v("读写")]),s._v("、"),_("strong",[s._v("关闭")]),s._v(" 都转换为 "),_("strong",[s._v("事件")]),s._v("，从而不用不在 "),_("strong",[s._v("网络")]),s._v(" "),_("code",[s._v("I/O")]),s._v(" 上浪费过多的时间，如图所示：")]),s._v(" "),_("p",[_("img",{attrs:{src:"http://img.liuwenqi.com/blog/2019-08-21-094922.jpg",alt:""}})]),s._v(" "),_("h3",{attrs:{id:"_4-3-单线程避免线程切换和竞态产生的消耗"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-单线程避免线程切换和竞态产生的消耗"}},[s._v("#")]),s._v(" 4.3. 单线程避免线程切换和竞态产生的消耗")]),s._v(" "),_("p",[s._v("采用 "),_("strong",[s._v("单线程")]),s._v(" 就能达到如此 "),_("strong",[s._v("高的性能")]),s._v("，那么不失为一种不错的选择，因为 "),_("strong",[s._v("单线程")]),s._v(" 能带来几个好处：")]),s._v(" "),_("ul",[_("li",[_("strong",[s._v("单线程")]),s._v(" 可以简化 "),_("strong",[s._v("数据结构和算法")]),s._v(" 的实现，开发人员不需要了解复杂的 "),_("strong",[s._v("并发数据结构")]),s._v("。")]),s._v(" "),_("li",[_("strong",[s._v("单线程")]),s._v(" 避免了 "),_("strong",[s._v("线程切换")]),s._v(" 和 "),_("strong",[s._v("竞态")]),s._v(" 产生的消耗，对于服务端开发来说，"),_("strong",[s._v("锁和线程切换")]),s._v(" 通常是性能杀手。")])]),s._v(" "),_("div",{staticClass:"custom-block warning"},[_("p",{staticClass:"title"}),_("p",[_("strong",[s._v("单线程")]),s._v(" 的问题：对于 "),_("strong",[s._v("每个命令")]),s._v(" 的 "),_("strong",[s._v("执行时间")]),s._v(" 是有要求的。如果某个命令 "),_("strong",[s._v("执行过长")]),s._v("，会造成其他命令的 "),_("strong",[s._v("阻塞")]),s._v("，对于 "),_("code",[s._v("Redis")]),s._v(" 这种 "),_("strong",[s._v("高性能")]),s._v(" 的服务来说是致命的，所以 "),_("code",[s._v("Redis")]),s._v(" 是面向 "),_("strong",[s._v("快速执行")]),s._v(" 场景的数据库。")])]),_("h1",{attrs:{id:"小结"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),_("p",[s._v("本文堆 "),_("code",[s._v("Redis")]),s._v(" 的几种 "),_("strong",[s._v("数据结构")]),s._v(" 进行了概述，介绍了几个简单的 "),_("strong",[s._v("全局命令")]),s._v("，"),_("strong",[s._v("数据结构")]),s._v(" 和 "),_("strong",[s._v("内部编码")]),s._v(" 以及 "),_("strong",[s._v("单线程命令")]),s._v(" 处理机制分析。")])])}),[],!1,null,null,null);_.default=e.exports}}]);