(window.webpackJsonp=window.webpackJsonp||[]).push([[156],{567:function(s,n,a){"use strict";a.r(n);var t=a(2),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"nginx-版本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx-版本"}},[s._v("#")]),s._v(" nginx  版本")]),s._v(" "),n("h2",{attrs:{id:"nginx-官方版本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx-官方版本"}},[s._v("#")]),s._v(" nginx 官方版本")]),s._v(" "),n("h3",{attrs:{id:"安装与配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装与配置"}},[s._v("#")]),s._v(" 安装与配置")]),s._v(" "),n("h4",{attrs:{id:"源码包安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#源码包安装"}},[s._v("#")]),s._v(" 源码包安装")]),s._v(" "),n("ul",[n("li",[s._v("下载nginx对应版本源码包")]),s._v(" "),n("li",[s._v("安装编译参数")])]),s._v(" "),n("p",[n("code",[s._v("./configure --user=www --group=www --prefix=/app/nginx --with-http_stub_status_module --with-http_ssl_module")])]),s._v(" "),n("h4",{attrs:{id:"yum-安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#yum-安装"}},[s._v("#")]),s._v(" yum 安装")]),s._v(" "),n("p",[n("code",[s._v("yum install nginx")])]),s._v(" "),n("h2",{attrs:{id:"使用方向"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用方向"}},[s._v("#")]),s._v(" 使用方向")]),s._v(" "),n("h3",{attrs:{id:"tengine-做前端负载及缓存"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tengine-做前端负载及缓存"}},[s._v("#")]),s._v(" tengine 做前端负载及缓存")]),s._v(" "),n("div",{staticClass:"language-yml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[s._v("        http "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        include       mime.types;\n        default_type  application/octet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stream;\n        autoindex     off;\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##linux 2.4+   network optimize")]),s._v("\n        sendfile        on;\n        tcp_nopush     on;\n        tcp_nodelay    on;\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## tengine")]),s._v("\n        server_info     off;\n        server_tag    off;\n        server_tokens off;\n        access_log    off;\n\n        keepalive_timeout  60;\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 限制header clien_body 大小等参数")]),s._v("\n        server_names_hash_bucket_size 128;\n        client_header_buffer_size 32k;\n        large_client_header_buffers 4 32k;\n        client_max_body_size 10m;\n        client_body_buffer_size 256k;\n\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##cache_buff_tmp")]),s._v("\n\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  fastcgi_intercept_errors on;")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  fastcgi_hide_header X-Powered-By;")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  fastcgi_connect_timeout 180;")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  fastcgi_send_timeout 180;")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  fastcgi_read_timeout 180;")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  fastcgi_buffer_size 128k;")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  fastcgi_buffers 4 128K;")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  fastcgi_busy_buffers_size 128k;")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  fastcgi_temp_file_write_size 128k;")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  fastcgi_temp_path /home/cache_php;")]),s._v("\n\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#gzip  on;")]),s._v('\n        gzip on;\n        gzip_min_length 1k;\n        gzip_buffers 4 16k;\n        gzip_http_version 1.0;\n        gzip_comp_level 4;\n        gzip_disable "MSIE '),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v('.";\n        gzip_types text/plain application/x'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("javascript text/css  text/javascript application/json application/x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("httpd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("php application/xml;\n        gzip_vary on;\n\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### lua  moty   add")]),s._v('\n        lua_package_path "/opt/nginx/conf/waf/'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v('.lua";\n        lua_shared_dict limit 10m;\n        init_by_lua_file  /opt/nginx/conf/waf/init.lua;\n        access_by_lua_file /opt/nginx/conf/waf/waf.lua;\n\n\n        '),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###  upstream     ")]),s._v("\n        include vhost/upstream.conf ;\n\n        log_format access '$remote_addr "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" $remote_user "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("$time_local"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(' "$request"\'\n            \'$status $body_bytes_sent "$http_referer"\'\n            \'"$http_user_agent" $http_x_forwarded_for\';\n\n        '),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### whiteIPlist")]),s._v("\n        geo $whiteiplist  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            default 1;\n            192.168.6.0/24 0;\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            map $whiteiplist  $limit "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('\n            1 $binary_remote_addr;\n            0 "";\n        '),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### limite  session")]),s._v("\n\n        limit_req_zone $cookie_token zone=session_limit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("20m rate=10r/s;\n        limit_req_zone $binary_remote_addr $uri zone=auth_limit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("20m rate=10r/m;\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###  proxy_buffer   ")]),s._v("\n        proxy_connect_timeout 600;\n        proxy_read_timeout 600;\n        proxy_send_timeout 600;\n        proxy_buffer_size 128k;\n        proxy_buffers 4 128k;\n        proxy_busy_buffers_size 256k;\n        proxy_temp_file_write_size 256k;\n        proxy_headers_hash_max_size 1024;\n        proxy_headers_hash_bucket_size 128;\n\n        proxy_redirect off;\n        proxy_set_header Host $host;\n        proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("IP $remote_addr;\n        proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Forwarded"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("For $proxy_add_x_forwarded_for;\n\n        proxy_temp_path /home/data/nginx/nginx_temp;\n        proxy_cache_path /home/data/nginx/nginx_cache levels=1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("2 keys_zone=cache_one"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("2048m inactive=30m max_size=60g;\n\n\n           "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# proxy_temp_path   /home/cache/nginx/proxy_temp;")]),s._v("\n           "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# proxy_cache_path  /home/cache/nginx/proxy_cache_www levels=1:2   keys_zone=cache_www:3000m inactive=1d max_size=20g;")]),s._v("\n\n            include  vhost/ap18game.com.conf;\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 创建 负载均衡配置文件")]),s._v("\n        upstream webserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        consistent_hash $request_uri;\n        server web1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("80 weight=1;\n        server web2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v('80 weight=1;\n        session_sticky;\n\n\n        check interval=3000 rise=2 fall=5 timeout=1000 type=http;\n        check_http_send "GET / HTTP/1.0\\r\\n\\r\\n";\n        check_http_expect_alive http_2xx http_3xx;\n        '),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n\n        server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        listen       80;\n        server_name  webserver;\n        root         /home/data/nginx/nginx_cache;\n        index        index.php index.html index.htm;\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#charset koi8-r;")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##access_log")]),s._v("\n        access_log  /home/data/nginx/logs/webserver.access.log  access;\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#trim on;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#trim_jscss on;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#location / {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    root   html;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    index  index.html index.htm;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n\n        location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_next_upstream http_500 http_502 http_503 http_504 error timeout invalid_header;\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#if (-d $request_filename) {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    rewrite ^/(.*)$ http://$host/index.html break;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##  defend   CC    lua简单防CC")]),s._v("\n            limit_req zone=session_limit burst=5;\n             rewrite_by_lua '\n             local random = ngx.var.cookie_random\n             if (random == nil) then\n                return ngx.redirect(\"/auth"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v('url=" .. ngx.var.request_uri)\n             end\n            local token = ngx.md5("opencdn" .. ngx.var.remote_addr .. random)\n            if (ngx.var.cookie_token ~= token) then\n                  return ngx.redirect("/auth'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("url=\".. ngx.var.request_uri)\n            end\n        ';\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 负载均衡")]),s._v("\n            proxy_redirect         off;\n            proxy_set_header Host $host;\n            proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("IP $remote_addr;\n            proxy_set_header  X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Forwarded"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("For $proxy_add_x_forwarded_for;\n            proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//webserver;\n       "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###  defend  CC")]),s._v("\n        location /auth "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('\n        limit_req zone=auth_limit burst=1;\n        if ($arg_url = "") '),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            return 403;\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v('\n        access_by_lua \'\n            local random = math.random(9999)\n            local token = ngx.md5("opencdn" .. ngx.var.remote_addr .. random)\n            if (ngx.var.cookie_token ~= token) then\n                ngx.header'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Set-Cookie"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" = "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"token=" .. token'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(' "random=" .. random'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                return ngx.redirect(ngx.var.arg_url)\n            end\n        ';\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#location ~ .*\\. (php)?$ {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#       proxy_next_upstream http_500 http_502 http_503 http_504 error timeout invalid_header;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#       proxy_pass http://webserver;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###  前端缓存")]),s._v("\n        location ~ ."),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("*\\.(htm|html|js|css|gif|jpg|jpeg|png|bmp|ico|swf|flv|otf)$")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                proxy_next_upstream http_500 http_502 http_503 http_504 error timeout invalid_header;\n                proxy_cache cache_one;\n                proxy_cache_valid 200 304 15m;\n                proxy_cache_valid 301 302 10m;\n                proxy_cache_valid any 1m;\n                proxy_cache_key $host$uri$is_args$args;\n                add_header Ten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("webcache '$upstream_cache_status from $host';\n                proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//webserver;\n                expires 30m;\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##  test lua")]),s._v("\n        location /lua "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                default_type 'text/plain';\n                content_by_lua 'ngx.say(\"hello"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lua\")';\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#error_page  404              /404.html;")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redirect server error pages to the static page /50x.html")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            root   html;\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        location /nstatus "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                check_status;\n                access_log off;\n                allow 182.52.236.240;\n                deny all;\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br"),n("span",{staticClass:"line-number"},[s._v("153")]),n("br"),n("span",{staticClass:"line-number"},[s._v("154")]),n("br"),n("span",{staticClass:"line-number"},[s._v("155")]),n("br"),n("span",{staticClass:"line-number"},[s._v("156")]),n("br"),n("span",{staticClass:"line-number"},[s._v("157")]),n("br"),n("span",{staticClass:"line-number"},[s._v("158")]),n("br"),n("span",{staticClass:"line-number"},[s._v("159")]),n("br"),n("span",{staticClass:"line-number"},[s._v("160")]),n("br"),n("span",{staticClass:"line-number"},[s._v("161")]),n("br"),n("span",{staticClass:"line-number"},[s._v("162")]),n("br"),n("span",{staticClass:"line-number"},[s._v("163")]),n("br"),n("span",{staticClass:"line-number"},[s._v("164")]),n("br"),n("span",{staticClass:"line-number"},[s._v("165")]),n("br"),n("span",{staticClass:"line-number"},[s._v("166")]),n("br"),n("span",{staticClass:"line-number"},[s._v("167")]),n("br"),n("span",{staticClass:"line-number"},[s._v("168")]),n("br"),n("span",{staticClass:"line-number"},[s._v("169")]),n("br"),n("span",{staticClass:"line-number"},[s._v("170")]),n("br"),n("span",{staticClass:"line-number"},[s._v("171")]),n("br"),n("span",{staticClass:"line-number"},[s._v("172")]),n("br"),n("span",{staticClass:"line-number"},[s._v("173")]),n("br"),n("span",{staticClass:"line-number"},[s._v("174")]),n("br"),n("span",{staticClass:"line-number"},[s._v("175")]),n("br"),n("span",{staticClass:"line-number"},[s._v("176")]),n("br"),n("span",{staticClass:"line-number"},[s._v("177")]),n("br"),n("span",{staticClass:"line-number"},[s._v("178")]),n("br"),n("span",{staticClass:"line-number"},[s._v("179")]),n("br"),n("span",{staticClass:"line-number"},[s._v("180")]),n("br"),n("span",{staticClass:"line-number"},[s._v("181")]),n("br"),n("span",{staticClass:"line-number"},[s._v("182")]),n("br"),n("span",{staticClass:"line-number"},[s._v("183")]),n("br"),n("span",{staticClass:"line-number"},[s._v("184")]),n("br"),n("span",{staticClass:"line-number"},[s._v("185")]),n("br"),n("span",{staticClass:"line-number"},[s._v("186")]),n("br"),n("span",{staticClass:"line-number"},[s._v("187")]),n("br"),n("span",{staticClass:"line-number"},[s._v("188")]),n("br"),n("span",{staticClass:"line-number"},[s._v("189")]),n("br"),n("span",{staticClass:"line-number"},[s._v("190")]),n("br"),n("span",{staticClass:"line-number"},[s._v("191")]),n("br"),n("span",{staticClass:"line-number"},[s._v("192")]),n("br"),n("span",{staticClass:"line-number"},[s._v("193")]),n("br"),n("span",{staticClass:"line-number"},[s._v("194")]),n("br"),n("span",{staticClass:"line-number"},[s._v("195")]),n("br"),n("span",{staticClass:"line-number"},[s._v("196")]),n("br"),n("span",{staticClass:"line-number"},[s._v("197")]),n("br"),n("span",{staticClass:"line-number"},[s._v("198")]),n("br"),n("span",{staticClass:"line-number"},[s._v("199")]),n("br"),n("span",{staticClass:"line-number"},[s._v("200")]),n("br"),n("span",{staticClass:"line-number"},[s._v("201")]),n("br"),n("span",{staticClass:"line-number"},[s._v("202")]),n("br"),n("span",{staticClass:"line-number"},[s._v("203")]),n("br"),n("span",{staticClass:"line-number"},[s._v("204")]),n("br"),n("span",{staticClass:"line-number"},[s._v("205")]),n("br"),n("span",{staticClass:"line-number"},[s._v("206")]),n("br"),n("span",{staticClass:"line-number"},[s._v("207")]),n("br"),n("span",{staticClass:"line-number"},[s._v("208")]),n("br"),n("span",{staticClass:"line-number"},[s._v("209")]),n("br"),n("span",{staticClass:"line-number"},[s._v("210")]),n("br"),n("span",{staticClass:"line-number"},[s._v("211")]),n("br"),n("span",{staticClass:"line-number"},[s._v("212")]),n("br"),n("span",{staticClass:"line-number"},[s._v("213")]),n("br"),n("span",{staticClass:"line-number"},[s._v("214")]),n("br"),n("span",{staticClass:"line-number"},[s._v("215")]),n("br"),n("span",{staticClass:"line-number"},[s._v("216")]),n("br"),n("span",{staticClass:"line-number"},[s._v("217")]),n("br"),n("span",{staticClass:"line-number"},[s._v("218")]),n("br"),n("span",{staticClass:"line-number"},[s._v("219")]),n("br"),n("span",{staticClass:"line-number"},[s._v("220")]),n("br"),n("span",{staticClass:"line-number"},[s._v("221")]),n("br"),n("span",{staticClass:"line-number"},[s._v("222")]),n("br"),n("span",{staticClass:"line-number"},[s._v("223")]),n("br")])]),n("h3",{attrs:{id:"nginx-做网站防火墙"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx-做网站防火墙"}},[s._v("#")]),s._v(" nginx 做网站防火墙")]),s._v(" "),n("p",[n("strong",[s._v("主要使用使用lua   waf模块.")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone http://luajit.org/git/luajit-2.0.git\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://tengine.taobao.org/download/tengine-2.1.0.tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/loveshell/ngx_lua_waf\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" luajit-2.0 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout v2.1\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PREFIX")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/luajit\n解压安装tengine\n ./configure "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/nginx --with-http_lua_module --with-luajit-lib"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/luajit/lib/ --with-luajit-inc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/luajit/include/luajit-2.1/ --with-ld-opt"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-Wl,-rpath,/usr/local/luajit/lib\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h4",{attrs:{id:"测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[s._v("#")]),s._v(" 测试")]),s._v(" "),n("p",[s._v("在nginx.conf中添加一个location")]),s._v(" "),n("div",{staticClass:"language-lua line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-lua"}},[n("code",[s._v("location "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("lua")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     default_type "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'text/plain'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    content_by_lua "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ngx.say(\"hello, lua\")'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h4",{attrs:{id:"配置ngx-lua-waf"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置ngx-lua-waf"}},[s._v("#")]),s._v(" 配置ngx_lua_waf")]),s._v(" "),n("p",[s._v("nginx下常见的"),n("strong",[s._v("开源waf")]),s._v("有mod_security、naxsi、ngx_lua_waf这三个，mod_security是最老牌的，功能最强规则细定制性又强，但是配置最复杂高并发时性能差。naxsi是原生nginx下的waf，性能不错但是基于白名单，配置也很麻烦。ngx_lua_waf功能和规则虽然没有这两个强大，但赢在性能高和易用性强，基本上零配置，而且常见的攻击类型都能防御，是比较省心的选择。安装好ngx_lua后，把下载好的ngx_lua_waf复制到conf目录下,重命名为waf，在nginx.conf的http段添加：")]),s._v(" "),n("div",{staticClass:"language-lua line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-lua"}},[n("code",[s._v("lua_package_path "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/nginx/conf/waf/?.lua"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nlua_shared_dict limit 10m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\ninit_by_lua_file  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginxconf"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("waf"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("init"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lua"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\naccess_by_lua_file "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("waf"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("waf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lua"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("修改/opt/nginx/conf/waf/config.lua文件，该文件为waf的配置文件，将RulePath和logdir改为实际的目录：")]),s._v(" "),n("div",{staticClass:"language-lua line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-lua"}},[n("code",[s._v("RulePath "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/nginx/conf/waf/wafconf/"')]),s._v("\nlogdir "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/nginx/logs/waf"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("//")]),s._v("确保此文件夹nginx有写入权限\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("其它的安全配置，按照实际需要开启。设置好和启动nginx")]),s._v(" "),n("h3",{attrs:{id:"nginx-做后端代理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx-做后端代理"}},[s._v("#")]),s._v(" nginx 做后端代理")]),s._v(" "),n("h4",{attrs:{id:"nginx-做后端处理配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx-做后端处理配置"}},[s._v("#")]),s._v(" nginx 做后端处理配置")]),s._v(" "),n("div",{staticClass:"language-yml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[s._v("user  www www;\nworker_processes  8;\nworker_cpu_affinity 00000001 00000010 00000100 00001000 00010000 00100000 01000000 10000000;\n\nerror_log  logs/error.log;\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#error_log  logs/error.log  notice;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#error_log  logs/error.log  info;")]),s._v("\n\npid        logs/nginx.pid;\nworker_rlimit_nofile  65535;\n\n\nevents "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    use epoll;\n    worker_connections  65535;\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\nhttp "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    include       mime.types;\n    default_type  application/octet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stream;\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#                  '$status $body_bytes_sent \"$http_referer\" '")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#                  \'"$http_user_agent" "$http_x_forwarded_for"\';')]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#log_format short '[$time_local] | $status | $host | $request | $remote_addr | $http_user_agent | $http_referer | $http_cookie';")]),s._v("\n    log_format  short '$remote_addr "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" $remote_user "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("$time_local"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(' "$request" \' \'$status $body_bytes_sent "$http_referer" \' \'"$http_user_agent" "$http_x_forwarded_for" $request_body $host "$http_cookie" \' \'$upstream_response_time $request_time \';\n    '),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#access_log  logs/access.log  short;")]),s._v("\n\n    sendfile        on;\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#tcp_nopush     on;")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#keepalive_timeout  0;")]),s._v("\n    keepalive_timeout  65;\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#gzip  on;")]),s._v("\n\n    server_tokens off;\n\n    charset     UTF"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("8;\n    server_names_hash_bucket_size       128;\n    client_header_buffer_size           4k;\n    large_client_header_buffers  4      32k;\n    client_max_body_size 30m;\n    client_body_buffer_size 128k;\n    fastcgi_connect_timeout 300;\n    fastcgi_read_timeout 300;\n    fastcgi_send_timeout 300;\n    fastcgi_buffer_size 64k;\n    fastcgi_buffers   4 32k;\n    fastcgi_busy_buffers_size 64k;\n    fastcgi_temp_file_write_size 64k;\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####open_file_cache")]),s._v("\n    open_file_cache max=65536  inactive=60s;\n    open_file_cache_valid      80s;\n    open_file_cache_min_uses   1;\n\n    include ./vhost/"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("*.conf;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);