(window.webpackJsonp=window.webpackJsonp||[]).push([[174],{577:function(s,a,t){"use strict";t.r(a);var n=t(2),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"linux下安装部署ansible"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux下安装部署ansible"}},[s._v("#")]),s._v(" Linux下安装部署Ansible")]),s._v(" "),a("p",[s._v("介绍\nAnsible是一种批量部署工具，现在运维人员用的最多的三种开源集中化管理工具有：puppet,saltstack,ansible，各有各的优缺点，其中saltstack和ansible都是用python开发的。ansible其实准确的说只提供了一个框架，它要基于很多其他的python模块才能工作的，所以在安装ansible的时候你要再装很多其他的依赖包的。")]),s._v(" "),a("p",[s._v("好处之一是使用者可以开发自己的模块，放在里面使用。第二个好处是无需在客户端安装agent，更新时，只需在操作机上进行一次更新即可。第三个好处是批量任务执行可以写成脚本，而且不用分发到远程就可以执行。")]),s._v(" "),a("p",[s._v("正文\n注意：强烈建议升级python版本到2.6以上，不然运行会出错或者有些功能会没有，在编译安装其他包的时候也会因为兼容问题报错。")]),s._v(" "),a("h2",{attrs:{id:"_1-、python2-7安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-、python2-7安装"}},[s._v("#")]),s._v(" (1)、python2.7安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("    https://www.python.org/ftp/python/2.7.8/Python-2.7.8.tgz\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xvzf Python-2.7.8.tgz\n    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" Python-2.7.8\n    ./configure "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"将python头文件拷贝到标准目录-以避免编译ansible时-找不到所需的头文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将python头文件拷贝到标准目录-以避免编译ansible时-找不到所需的头文件"}},[s._v("#")]),s._v(" 将python头文件拷贝到标准目录，以避免编译ansible时，找不到所需的头文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/include/python2.7\n     "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" ./* /usr/local/include/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"备份旧版本的python-并符号链接新版本的python"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份旧版本的python-并符号链接新版本的python"}},[s._v("#")]),s._v(" 备份旧版本的python，并符号链接新版本的python")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/bin\n     "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" python python.old\n     "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /usr/local/bin/python2.7 /usr/local/bin/python\n     "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /usr/bin/python "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/bin/python2.7 /usr/bin/python\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"修改yum脚本-使其指向旧版本的python-已避免其无法运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改yum脚本-使其指向旧版本的python-已避免其无法运行"}},[s._v("#")]),s._v(" 修改yum脚本，使其指向旧版本的python，已避免其无法运行")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /usr/bin/yum\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/python  --\x3e  #!/usr/bin/python2.4")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"_2-、setuptools模块安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-、setuptools模块安装"}},[s._v("#")]),s._v(" (2)、setuptools模块安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("    https://pypi.python.org/packages/source/s/setuptools/setuptools-7.0.tar.gz\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar xvzf setuptools-7.0.tar.gz")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd setuptools-7.0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# python setup.py install")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("安装好setuptools后就可以利用easy_install这个工具安装下面的python模块了，但我的电脑是虚拟机，配置太低了，所以基本无法安装，所以只好一个一个下载下来再安装了。")]),s._v(" "),a("h2",{attrs:{id:"_3-、pycrypto模块安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-、pycrypto模块安装"}},[s._v("#")]),s._v(" (3)、pycrypto模块安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("    https://pypi.python.org/packages/source/p/pycrypto/pycrypto-2.6.1.tar.gz\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar xvzf pycrypto-2.6.1.tar.gz")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd pycrypto-2.6.1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# python setup.py install")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"_4-、pyyaml模块安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-、pyyaml模块安装"}},[s._v("#")]),s._v(" (4)、PyYAML模块安装")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("http://pyyaml.org/download/libyaml/yaml-0.1.5.tar.gz\n# tar xvzf yaml-0.1.5.tar.gz\n# cd yaml-0.1.5\n# ./configure --prefix=/usr/local\n# make --jobs=`grep processor/proc/cpuinfo | wc -l`\n# make install\n\n\nhttps://pypi.python.org/packages/source/P/PyYAML/PyYAML-3.11.tar.gz\n# tar xvzf PyYAML-3.11.tar.gz\n# cd PyYAML-3.11\n# python setup.py install\n")])])]),a("h2",{attrs:{id:"_5-、jinja2模块安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-、jinja2模块安装"}},[s._v("#")]),s._v(" (5)、Jinja2模块安装")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("https://pypi.python.org/packages/source/M/MarkupSafe/MarkupSafe-0.9.3.tar.gz\n# tar xvzf MarkupSafe-0.9.3.tar.gz\n# cd MarkupSafe-0.9.3\n# python setup.py install\n\n\nhttps://pypi.python.org/packages/source/J/Jinja2/Jinja2-2.7.3.tar.gz\n# tar xvzf Jinja2-2.7.3.tar.gz\n# cd Jinja2-2.7.3\n# python setup.py install\n")])])]),a("h2",{attrs:{id:"_6-、paramiko模块安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-、paramiko模块安装"}},[s._v("#")]),s._v(" (6)、paramiko模块安装")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("https://pypi.python.org/packages/source/e/ecdsa/ecdsa-0.11.tar.gz\n# tar xvzf ecdsa-0.11.tar.gz\n# cd ecdsa-0.11\n# python setup.py install\n\n\nhttps://pypi.python.org/packages/source/p/paramiko/paramiko-1.15.1.tar.gz\n# tar xvzf paramiko-1.15.1.tar.gz\n# cd paramiko-1.15.1\n# python setup.py install\n")])])]),a("h2",{attrs:{id:"_7-、simplejson模块安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-、simplejson模块安装"}},[s._v("#")]),s._v(" (7)、simplejson模块安装")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("https://pypi.python.org/packages/source/s/simplejson/simplejson-3.6.5.tar.gz\n# tar xvzf simplejson-3.6.5.tar.gz\n# cd simplejson-3.6.5\n# python setup.py install\n")])])]),a("h2",{attrs:{id:"_8-、ansible安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-、ansible安装"}},[s._v("#")]),s._v(" (8)、ansible安装")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("https://github.com/ansible/ansible/archive/v1.7.2.tar.gz\n# tar xvzf ansible-1.7.2.tar.gz\n# cd ansible-1.7.2\n# python setup.py install\n")])])]),a("h2",{attrs:{id:"_9-、ssh免密钥登录设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-、ssh免密钥登录设置"}},[s._v("#")]),s._v(" (9)、SSH免密钥登录设置")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("## 生成公钥/私钥\n# ssh-keygen -t rsa -P ''\n## 写入信任文件（将/root/.ssh/id_rsa_storm1.pub分发到其他服务器，并在所有服务器上执行如下指令）：\n# cat /root/.ssh/id_rsa_storm1.pub >> /root/.ssh/authorized_keys\n# chmod 600 /root/.ssh/authorized_keys\n")])])]),a("h2",{attrs:{id:"_10-、拷贝-生成ansible配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-、拷贝-生成ansible配置文件"}},[s._v("#")]),s._v(" (10)、拷贝，生成ansible配置文件")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("a 配置文件/etc/ansible/ansible.cfg\n# mkdir -p /etc/ansible\n#cp ansible-1.7.2/examples/ansible.cfg /etc/ansible/\nb 配置文件/etc/ansible/hosts\n# vim /etc/ansible/hosts\n[test]\n192.168.110.20\n192.168.110.30\n")])])]),a("h2",{attrs:{id:"测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[s._v("#")]),s._v(" 测试")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("# ansible test -m command -a 'uptime'\n## 用来测试远程主机的运行状态\n# ansible test -m ping\n")])])]),a("p",[s._v("参看所有的参数\nansible-doc -l")]),s._v(" "),a("p",[s._v("Ansible和Docker的作用和用法  http://www.linuxidc.com/Linux/2014-11/109783.htm")]),s._v(" "),a("p",[s._v("Ansible批量搭建LAMP环境 http://www.linuxidc.com/Linux/2014-10/108264.htm")]),s._v(" "),a("p",[s._v("Ansible ：一个配置管理和IT自动化工具  http://www.linuxidc.com/Linux/2014-11/109365.htm")]),s._v(" "),a("p",[s._v("Ansible 的详细介绍：请点这里\nAnsible 的下载地址：请点这里")]),s._v(" "),a("p",[s._v("本文永久更新链接地址：http://www.linuxidc.com/Linux/2015-02/112774.htm")])])}),[],!1,null,null,null);a.default=e.exports}}]);