(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{523:function(s,t,n){"use strict";n.r(t);var a=n(2),e=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"memcached使用及相关配置和使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#memcached使用及相关配置和使用"}},[s._v("#")]),s._v(" memcached使用及相关配置和使用")]),s._v(" "),t("h2",{attrs:{id:"linux下memcached的启动-结束的方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux下memcached的启动-结束的方式"}},[s._v("#")]),s._v(" linux下memcached的启动/结束的方式")]),s._v(" "),t("p",[s._v("当前项目中，linux下memcached的启动/结束的方式")]),s._v(" "),t("blockquote",[t("p",[s._v("默认情况下memcached安装到/usr/local/bin下。")])]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[s._v("进入安装目录，启动memcached"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/usr/local/memcached/bin/memcached "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("c 10240 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("m 1024 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("u root\n获取运行状态：echo stats "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" nc localhost 11211(可以查看出pid) 或使用ps "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ef"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v("grep memcached\n停止memcached：kill "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("9 pid  ("),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("9表示强制杀死"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pid 为进程的进程标识符)\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d 选项是启动一个守护进程，\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("m 是分配给memcache使用的内存数量，单位是mb，这里是1024mb，默认是64mb\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("u 是运行memcache的用户，这里是root\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("l 是监听的服务器ip地址，默认应该是本机\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p 是设置memcache监听的端口，默认是11211，最好是1024以上的端口\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("c 选项是最大运行的并发连接数，默认是1024，这里设置了10240，按照你服务器的负载量来设定\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p 是设置保存memcache的pid文件位置\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("h 打印帮助信息\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("v 输出警告和错误信息\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("vv 打印客户端的请求和返回信息\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[s._v("ps "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ef"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v("grep memcached（命令说明） \ngrep"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("功能说明：查找文件里符合条件的字符串。\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("管道命令操作符\nps(process status)"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("功能说明：报告程序状况。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("连接到 memcached：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("telnet "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" 端口，如telnet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.11 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11211")]),s._v("\nstats查看状态，flush_all:清楚缓存\n查看memcached状态的基本命令，通过这个命令可以看到如下信息：\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" pid "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22459")]),s._v("                             进程id\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("uptime")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1027046")]),s._v("                        服务器运行秒数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1273043062")]),s._v("                       服务器当前unix时间戳\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.4")]),s._v(".4                         服务器版本\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" pointer_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("                       操作系统字大小"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("这台服务器是64位的"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" rusage_user "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.040000")]),s._v("                  进程累计用户时间\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" rusage_system "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.260000")]),s._v("                进程累计系统时间\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" curr_connections "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("                   当前打开连接数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" total_connections "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("82")]),s._v("                  曾打开的连接总数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" connection_structures "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v("              服务器分配的连接结构数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" cmd_get "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("54")]),s._v("                            执行get命令总数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" cmd_set "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("                            执行set命令总数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" cmd_flush "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("                           指向flush_all命令总数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" get_hits "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("                            get命中次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" get_misses "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v("                         get未命中次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" delete_misses "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("                       delete未命中次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" delete_hits "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                         delete命中次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" incr_misses "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                         incr未命中次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" incr_hits "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                           incr命中次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" decr_misses "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                         decr未命中次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" decr_hits "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                           decr命中次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" cas_misses "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                          cas未命中次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" cas_hits "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                            cas命中次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" cas_badval "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                          使用擦拭次数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" auth_cmds "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" auth_errors "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" bytes_read "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15785")]),s._v("                      读取字节总数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" bytes_written "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15222")]),s._v("                   写入字节总数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" limit_maxbytes "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v("                分配的内存数（字节）\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" accepting_conns "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                     目前接受的链接数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" listen_disabled_num "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" threads "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("                             线程数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" conn_yields "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" bytes "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                               存储item字节数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" curr_items "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                          item个数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" total_items "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("                        item总数\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" evictions "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                           为获取空间删除item的总数\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br")])]),t("p",[s._v("另外一个例子：\n启动/结束")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[s._v("memcached "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("m 10 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("u root "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("l 192.168.0.122 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p 11200 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("c 256 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p /tmp/memcached.pid\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d 选项是启动一个守护进程，\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("m 是分配给memcache使用的内存数量，单位是mb，这里是10mb\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("u 是运行memcache的用户，这里是root\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("l 是监听的服务器ip地址，如果有多个地址的话，这里指定了服务器的ip地址192.168.0.122\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p 是设置memcache监听的端口，这里设置了12000，最好是1024以上的端口\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("c 选项是最大运行的并发连接数，默认是1024，这里设置了256，按照你服务器的负载量来设定\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p 是设置保存memcache的pid文件\nkill `cat /tmp/memcached.pid`\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("获取运行状态")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[s._v("echo stats "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(' nc 192.168.1.123 11200\nwatch "echo stats '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(' nc 192.168.1.123 11200" (实时状态)\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);